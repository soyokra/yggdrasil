<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abstractapplicationcontext.Invokebeanfactorypostprocessors - 技术文档</title>
    <link rel="stylesheet" href="../../../../assets/style.css">
    <link rel="stylesheet" href="../../../../assets/github.min.css">
    <script src="../../../../assets/highlight.min.js"></script>
    <script src="../../../../assets/python.min.js"></script>
    <script src="../../../../assets/java.min.js"></script>
    <script src="../../../../assets/javascript.min.js"></script>
    <script src="../../../../assets/xml.min.js"></script>
    <script src="../../../../assets/css.min.js"></script>
    <script src="../../../../assets/bash.min.js"></script>
    <script src="../../../../assets/sql.min.js"></script>
</head>

<body>
    <!-- 顶部导航栏 -->
    <div class="top-navbar">
        <div class="site-title">技术文档</div>
    </div>

    <!-- 侧边导航栏 -->
    <div class="sidebar">
        <ul class="nav-tree">
            <li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../../html/spring/index.html" class="nav-link-text" data-path="html/spring/index.html">spring</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../../html/spring/spring-boot/index.html" class="nav-link-text" data-path="html/spring/spring-boot/index.html">spring-boot</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-boot/actuator.html" class="nav-link-text" data-path="html/spring/spring-boot/actuator.html">Actuator</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-boot/autoconfigure.html" class="nav-link-text" data-path="html/spring/spring-boot/autoconfigure.html">Autoconfigure</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-boot/EnableConfigurationProperties注解.html" class="nav-link-text" data-path="html/spring/spring-boot/EnableConfigurationProperties注解.html">Enableconfigurationproperties注解</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-cloud/index.html" class="nav-link-text" data-path="html/spring/spring-cloud/index.html">spring-cloud</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-cloud-alibaba/index.html" class="nav-link-text" data-path="html/spring/spring-cloud-alibaba/index.html">spring-cloud-alibaba</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../../html/spring/spring-framework/index.html" class="nav-link-text" data-path="html/spring/spring-framework/index.html">spring-framework</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework/BeanDefinition.class.graph.html" class="nav-link-text" data-path="html/spring/spring-framework/BeanDefinition.class.graph.html">Beandefinition.Class.Graph</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework/BeanLifecycle.html" class="nav-link-text" data-path="html/spring/spring-framework/BeanLifecycle.html">Beanlifecycle</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../../html/spring/spring-framework-start/index.html" class="nav-link-text" data-path="html/spring/spring-framework-start/index.html">spring-framework-start</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../../html/spring/spring-framework-start/src/index.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/index.html">src</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.cancelRefresh.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.cancelRefresh.html">Abstractapplicationcontext.Cancelrefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.destroyBeans.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.destroyBeans.html">Abstractapplicationcontext.Destroybeans</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.finishBeanFactoryInitialization.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.finishBeanFactoryInitialization.html">Abstractapplicationcontext.Finishbeanfactoryinitialization</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.finishRefresh.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.finishRefresh.html">Abstractapplicationcontext.Finishrefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.initApplicationEventMulticaster.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.initApplicationEventMulticaster.html">Abstractapplicationcontext.Initapplicationeventmulticaster</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.initMessageSource.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.initMessageSource.html">Abstractapplicationcontext.Initmessagesource</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link active">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html">Abstractapplicationcontext.Invokebeanfactorypostprocessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.obtainFreshBeanFactory.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.obtainFreshBeanFactory.html">Abstractapplicationcontext.Obtainfreshbeanfactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.onRefresh.html">Abstractapplicationcontext.Onrefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.postProcessBeanFactory.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.postProcessBeanFactory.html">Abstractapplicationcontext.Postprocessbeanfactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.prepareBeanFactory.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.prepareBeanFactory.html">Abstractapplicationcontext.Preparebeanfactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.prepareRefresh.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.prepareRefresh.html">Abstractapplicationcontext.Preparerefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.registerBeanPostProcessors.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.registerBeanPostProcessors.html">Abstractapplicationcontext.Registerbeanpostprocessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.registerListeners.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.registerListeners.html">Abstractapplicationcontext.Registerlisteners</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AbstractApplicationContext.resetCommonCaches.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AbstractApplicationContext.resetCommonCaches.html">Abstractapplicationcontext.Resetcommoncaches</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/Application.createApplicationContext.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/Application.createApplicationContext.html">Application.Createapplicationcontext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/Application.refreshContext.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/Application.refreshContext.html">Application.Refreshcontext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/Application.run.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/Application.run.html">Application.Run</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/AutoConfigurationImportSelector.getAutoConfigurationEntry.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/AutoConfigurationImportSelector.getAutoConfigurationEntry.html">Autoconfigurationimportselector.Getautoconfigurationentry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/ClassPathMapperScanner.scan.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/ClassPathMapperScanner.scan.html">Classpathmapperscanner.Scan</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/ConfigurationClassParser.parse.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/ConfigurationClassParser.parse.html">Configurationclassparser.Parse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html">Configurationclasspostprocessor.Processconfigbeandefinitions</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html">Mapperscannerconfigurer.Postprocessbeandefinitionregistry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-framework-start/src/ServletWebServerApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring-framework-start/src/ServletWebServerApplicationContext.onRefresh.html">Servletwebserverapplicationcontext.Onrefresh</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../../html/spring/spring-mysql/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/index.html">spring-mysql</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/hikari/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/hikari/index.html">hikari</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/jdbc/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/jdbc/index.html">jdbc</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../../html/spring/spring-mysql/mybatis/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/index.html">mybatis</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/mybatis/Mapper.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/Mapper.html">Mapper</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/mybatis/XML.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/XML.html">Xml</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../../html/spring/spring-mysql/mybatis-plus/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/index.html">mybatis-plus</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/mybatis-plus/DataSource.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/DataSource.html">Datasource</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/mybatis-plus/Mapper.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/Mapper.html">Mapper</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/mybatis-plus/SQL执行.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL执行.html">Sql执行</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/mybatis-plus/SQL模板注册.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL模板注册.html">Sql模板注册</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/spring/spring-mysql/p6spy/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/p6spy/index.html">p6spy</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/java/index.html" class="nav-link-text" data-path="html/java/index.html">java</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/k8s/index.html" class="nav-link-text" data-path="html/k8s/index.html">k8s</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../../html/more/index.html" class="nav-link-text" data-path="html/more/index.html">more</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/ai/index.html" class="nav-link-text" data-path="html/more/ai/index.html">ai</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/algorithm/index.html" class="nav-link-text" data-path="html/more/algorithm/index.html">algorithm</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/clickhouse/index.html" class="nav-link-text" data-path="html/more/clickhouse/index.html">clickhouse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/data-structure/index.html" class="nav-link-text" data-path="html/more/data-structure/index.html">data-structure</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/design-pattern/index.html" class="nav-link-text" data-path="html/more/design-pattern/index.html">design-pattern</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/diagram/index.html" class="nav-link-text" data-path="html/more/diagram/index.html">diagram</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/elasticsearch/index.html" class="nav-link-text" data-path="html/more/elasticsearch/index.html">elasticsearch</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/kakfa/index.html" class="nav-link-text" data-path="html/more/kakfa/index.html">kakfa</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/mongodb/index.html" class="nav-link-text" data-path="html/more/mongodb/index.html">mongodb</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/nginx/index.html" class="nav-link-text" data-path="html/more/nginx/index.html">nginx</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/prometheus/index.html" class="nav-link-text" data-path="html/more/prometheus/index.html">prometheus</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/rabbitmq/index.html" class="nav-link-text" data-path="html/more/rabbitmq/index.html">rabbitmq</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../../html/more/redis/index.html" class="nav-link-text" data-path="html/more/redis/index.html">redis</a>
</div>
</li>
</ul>
</li>
        </ul>
    </div>

    <!-- 主内容区 -->
    <div class="main-content">
        <div class="content-body">
            <h2 id="_1">简述</h2>
<p>// 先注册BeanDefinition<br/>
执行BeanDefinitionRegistryPostProcessor.postProcessBeanDefinitionRegistry</p>
<p>// <br/>
执行BeanFactoryPostProcessor.postProcessBeanFactory</p>
<h2 id="_2">源码分析</h2>
<div class="hljs"><pre><span></span><code><span class="kd">final</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PostProcessorRegistrationDelegate</span><span class="w"> </span><span class="p">{</span>


<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">invokeBeanFactoryPostProcessors</span><span class="p">(</span>
<span class="w">          </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">beanFactoryPostProcessors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">       </span><span class="c1">// Invoke BeanDefinitionRegistryPostProcessors first, if any.</span>
<span class="w">       </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">processedBeans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanDefinitionRegistry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">           </span><span class="c1">// 第一步：先执行外部传入的 beanFactory后置处理器BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry方法</span>
<span class="w">          </span><span class="n">BeanDefinitionRegistry</span><span class="w"> </span><span class="n">registry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionRegistry</span><span class="p">)</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">;</span>
<span class="w">          </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">regularPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">          </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">registryProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">BeanFactoryPostProcessor</span><span class="w"> </span><span class="n">postProcessor</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanFactoryPostProcessors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">postProcessor</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="w"> </span><span class="n">registryProcessor</span><span class="w"> </span><span class="o">=</span>
<span class="w">                      </span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="n">postProcessor</span><span class="p">;</span>

<span class="w">                </span><span class="n">registryProcessor</span><span class="p">.</span><span class="na">postProcessBeanDefinitionRegistry</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span>
<span class="w">                </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">registryProcessor</span><span class="p">);</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">             </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">regularPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">postProcessor</span><span class="p">);</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>

<span class="w">          </span><span class="c1">// Do not initialize FactoryBeans here: We need to leave all regular beans</span>
<span class="w">          </span><span class="c1">// uninitialized to let the bean factory post-processors apply to them!</span>
<span class="w">          </span><span class="c1">// Separate between BeanDefinitionRegistryPostProcessors that implement</span>
<span class="w">          </span><span class="c1">// PriorityOrdered, Ordered, and the rest.</span>
<span class="w">          </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">currentRegistryProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">          </span><span class="c1">// 第二步：执行继承PriorityOrdered接口的beanFactory后置处理器BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry方法</span>
<span class="w">          </span><span class="c1">// 其实就是执行优先级高的，实际上是ConfigurationClassPostProcessor这个处理</span>
<span class="w">          </span><span class="c1">// ConfigurationClassPostProcessor就是注解类的解析，生成和注册BeanDefinition</span>
<span class="w">          </span><span class="c1">// 早期是xml方式，对于新增的注解方式，解决方案是增加 BeanDefinitionRegistryPostProcessor 这个扩展点</span>
<span class="w">          </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span>
<span class="w">                </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">PriorityOrdered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="w">                </span><span class="n">processedBeans</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
<span class="w">          </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">);</span>

<span class="w">          </span><span class="c1">// currentRegistryProcessors =&gt; ConfigurationClassPostProcessor</span>
<span class="w">          </span><span class="n">invokeBeanDefinitionRegistryPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">registry</span><span class="p">);</span>

<span class="w">          </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>

<span class="w">          </span><span class="c1">// 第三步：执行继承Ordered接口的beanFactory后置处理器BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry方法</span>
<span class="w">          </span><span class="c1">// 按顺序执行，默认情况下，并没有这种后置处理器</span>
<span class="w">          </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">processedBeans</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">ppName</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">Ordered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="w">                </span><span class="n">processedBeans</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
<span class="w">          </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">);</span>

<span class="w">           </span><span class="c1">// currentRegistryProcessors =&gt; empty</span>
<span class="w">          </span><span class="n">invokeBeanDefinitionRegistryPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">registry</span><span class="p">);</span>
<span class="w">          </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>

<span class="w">          </span><span class="c1">// 第四步：执行所有的beanFactory后置处理器BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry方法</span>
<span class="w">          </span><span class="c1">// 这里的while循环是考虑到postProcessBeanDefinitionRegistry方法里可能产生新的beanFactory后置处理器，要全部执行到</span>
<span class="w">          </span><span class="c1">// 使用mybatis的话，就会有MapperScannerConfigurer，扫描xxxMapper为BeanDefinition </span>
<span class="w">          </span><span class="kt">boolean</span><span class="w"> </span><span class="n">reiterate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">          </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reiterate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">reiterate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">             </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">             </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">processedBeans</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">ppName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                   </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="w">                   </span><span class="n">processedBeans</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
<span class="w">                   </span><span class="n">reiterate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">             </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
<span class="w">             </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">);</span>

<span class="w">             </span><span class="c1">// currentRegistryProcessors =&gt; MapperScannerConfigurer</span>
<span class="w">             </span><span class="n">invokeBeanDefinitionRegistryPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">registry</span><span class="p">);</span>
<span class="w">             </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
<span class="w">          </span><span class="p">}</span>

<span class="w">          </span><span class="c1">// BeanDefinitionRegistryPostProcessor继承BeanFactoryPostProcessor接口</span>
<span class="w">           </span><span class="c1">// 这里是执行一下BeanDefinitionRegistryPostProcessor类型后置处理的postProcessBeanFactory方法</span>
<span class="w">           </span><span class="c1">//registryProcessors =&gt; </span>
<span class="w">           </span><span class="c1">// CachingMetadataReaderFactoryPostProcessor</span>
<span class="w">           </span><span class="c1">// ConfigurationWarningsPostProcessor</span>
<span class="w">           </span><span class="c1">// ConfigurationClassPostProcessor</span>
<span class="w">           </span><span class="c1">// MapperScannerConfigurer</span>
<span class="w">          </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">registryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>

<span class="w">          </span><span class="c1">// regularPostProcessors =&gt;</span>
<span class="w">           </span><span class="c1">//PropertySourceOrderingPostProcessor</span>
<span class="w">          </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">regularPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
<span class="w">       </span><span class="p">}</span>

<span class="w">       </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// Invoke factory processors registered with the context instance.</span>
<span class="w">          </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">beanFactoryPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
<span class="w">       </span><span class="p">}</span>

<span class="w">       </span><span class="c1">// 按照 PriorityOrdered -&gt; Ordered -&gt; 普通的顺序执行beanFactory后置处理器BeanFactoryPostProcessor的postProcessBeanFactory方法</span>
<span class="w">       </span><span class="c1">// Do not initialize FactoryBeans here: We need to leave all regular beans</span>
<span class="w">       </span><span class="c1">// uninitialized to let the bean factory post-processors apply to them!</span>
<span class="w">       </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span>
<span class="w">             </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">       </span><span class="c1">// Separate between BeanFactoryPostProcessors that implement PriorityOrdered,</span>
<span class="w">       </span><span class="c1">// Ordered, and the rest.</span>
<span class="w">       </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">priorityOrderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">       </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderedPostProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">       </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">nonOrderedPostProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">processedBeans</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">ppName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="c1">// skip - already processed in first phase above</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">PriorityOrdered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">priorityOrderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">Ordered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">orderedPostProcessorNames</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">nonOrderedPostProcessorNames</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">       </span><span class="p">}</span>

<span class="w">       </span><span class="c1">// First, invoke the BeanFactoryPostProcessors that implement PriorityOrdered.</span>
<span class="w">       </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">priorityOrderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>

<span class="w">       </span><span class="c1">// priorityOrderedPostProcessors =&gt;</span>
<span class="w">        </span><span class="c1">// PropertySourcesPlaceholderConfigurer</span>
<span class="w">       </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">priorityOrderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>

<span class="w">       </span><span class="c1">// Next, invoke the BeanFactoryPostProcessors that implement Ordered.</span>
<span class="w">       </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">orderedPostProcessorNames</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">postProcessorName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">orderedPostProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">orderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">postProcessorName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">orderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>

<span class="w">       </span><span class="c1">// orderedPostProcessors =&gt; empty</span>
<span class="w">       </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">orderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>

<span class="w">       </span><span class="c1">// Finally, invoke all other BeanFactoryPostProcessors.</span>
<span class="w">       </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">nonOrderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">nonOrderedPostProcessorNames</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">postProcessorName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nonOrderedPostProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">nonOrderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">postProcessorName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="c1">// nonOrderedPostProcessors =&gt; </span>
<span class="w">        </span><span class="c1">// EventListenerMethodProcessor</span>
<span class="w">        </span><span class="c1">// PreserveErrorControllerTargetClassPostProcessor</span>
<span class="w">       </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">nonOrderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>

<span class="w">       </span><span class="c1">// Clear cached merged bean definitions since the post-processors might have</span>
<span class="w">       </span><span class="c1">// modified the original metadata, e.g. replacing placeholders in values...</span>
<span class="w">       </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">clearMetadataCache</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>BeanDefinitionRegistryPostProcessor.postProcessBeanDefinitionRegistry实现类</p>
<div class="hljs"><pre><span></span><code>ConfigurationClassPostProcessor
MapperScannerConfigurer
</code></pre></div>
<p>BeanFactoryPostProcessor.postProcessBeanFactory实现类</p>
<div class="hljs"><pre><span></span><code>SharedMetadataReaderFactoryContextInitializer$CachingMetadataReaderFactoryPostProcessor
ConfigurationWarningsApplicationContextInitializer$ConfigurationWarningsPostProcessor
ConfigurationClassPostProcessor
MapperScannerConfigurer

ConfigFileApplicationListener$PropertySourceOrderingPostProcessor
PropertySourcePlaceholderConfigurer
EventListenerMethodProcessor
ErrorMvcAutoConfiguration$PreserveErrorControllerTargetClassPostProcessor
</code></pre></div>
<p>ConfigurationClassPostProcessor.postProcessBeanDefinitionRegistry方法</p>
<p>扫描包下文件注册beanDefinition</p>
<p>通过 ClassPathBeanDefinitionScanner执行</p>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClassPathBeanDefinitionScanner</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ClassPathScanningCandidateComponentProvider</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">BeanDefinitionHolder</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">doScan</span><span class="p">(</span><span class="n">String</span><span class="p">...</span><span class="w"> </span><span class="n">basePackages</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Assert</span><span class="p">.</span><span class="na">notEmpty</span><span class="p">(</span><span class="n">basePackages</span><span class="p">,</span><span class="w"> </span><span class="s">"At least one base package must be specified"</span><span class="p">);</span>
<span class="w">        </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">BeanDefinitionHolder</span><span class="o">&gt;</span><span class="w"> </span><span class="n">beanDefinitions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedHashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">basePackage</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">basePackages</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">BeanDefinition</span><span class="o">&gt;</span><span class="w"> </span><span class="n">candidates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findCandidateComponents</span><span class="p">(</span><span class="n">basePackage</span><span class="p">);</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinition</span><span class="w"> </span><span class="n">candidate</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">candidates</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">ScopeMetadata</span><span class="w"> </span><span class="n">scopeMetadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">scopeMetadataResolver</span><span class="p">.</span><span class="na">resolveScopeMetadata</span><span class="p">(</span><span class="n">candidate</span><span class="p">);</span>
<span class="w">                </span><span class="n">candidate</span><span class="p">.</span><span class="na">setScope</span><span class="p">(</span><span class="n">scopeMetadata</span><span class="p">.</span><span class="na">getScopeName</span><span class="p">());</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanNameGenerator</span><span class="p">.</span><span class="na">generateBeanName</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">candidate</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">AbstractBeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">postProcessBeanDefinition</span><span class="p">((</span><span class="n">AbstractBeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="n">candidate</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">candidate</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">AnnotatedBeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">AnnotationConfigUtils</span><span class="p">.</span><span class="na">processCommonDefinitionAnnotations</span><span class="p">((</span><span class="n">AnnotatedBeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="n">candidate</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">checkCandidate</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">candidate</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">BeanDefinitionHolder</span><span class="w"> </span><span class="n">definitionHolder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionHolder</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
<span class="w">                    </span><span class="n">definitionHolder</span><span class="w"> </span><span class="o">=</span>
<span class="w">                            </span><span class="n">AnnotationConfigUtils</span><span class="p">.</span><span class="na">applyScopedProxyMode</span><span class="p">(</span><span class="n">scopeMetadata</span><span class="p">,</span><span class="w"> </span><span class="n">definitionHolder</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="p">);</span>
<span class="w">                    </span><span class="n">beanDefinitions</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">definitionHolder</span><span class="p">);</span>
<span class="w">                    </span><span class="n">registerBeanDefinition</span><span class="p">(</span><span class="n">definitionHolder</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">beanDefinitions</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>调用栈</p>
<div class="hljs"><pre><span></span><code>doScan:273, ClassPathBeanDefinitionScanner (org.springframework.context.annotation)
parse:132, ComponentScanAnnotationParser (org.springframework.context.annotation)
doProcessConfigurationClass:296, ConfigurationClassParser (org.springframework.context.annotation)
processConfigurationClass:250, ConfigurationClassParser (org.springframework.context.annotation)
parse:207, ConfigurationClassParser (org.springframework.context.annotation)
parse:175, ConfigurationClassParser (org.springframework.context.annotation)
processConfigBeanDefinitions:320, ConfigurationClassPostProcessor (org.springframework.context.annotation)
postProcessBeanDefinitionRegistry:237, ConfigurationClassPostProcessor (org.springframework.context.annotation)
invokeBeanDefinitionRegistryPostProcessors:280, PostProcessorRegistrationDelegate (org.springframework.context.support)
invokeBeanFactoryPostProcessors:96, PostProcessorRegistrationDelegate (org.springframework.context.support)
invokeBeanFactoryPostProcessors:707, AbstractApplicationContext (org.springframework.context.support)
refresh:533, AbstractApplicationContext (org.springframework.context.support)
refresh:143, ServletWebServerApplicationContext (org.springframework.boot.web.servlet.context)
refresh:755, SpringApplication (org.springframework.boot)
refresh:747, SpringApplication (org.springframework.boot)
refreshContext:402, SpringApplication (org.springframework.boot)
run:312, SpringApplication (org.springframework.boot)
main:35, StartApplication (com.zuzuche.widget.start)
</code></pre></div>
<h3 id="_3"></h3>
        </div>
    </div>

    <script src="../../../../assets/script.js"></script>
    <script>
        // 初始化代码高亮
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        });
    </script>
</body>

</html>