<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AbstractApplicationContext.finishRefresh - Technology</title>
    <link rel="stylesheet" href="../../../assets/style.css">
    <link rel="stylesheet" href="../../../assets/github.min.css">
    <script src="../../../assets/highlight.min.js"></script>
    <script src="../../../assets/python.min.js"></script>
    <script src="../../../assets/java.min.js"></script>
    <script src="../../../assets/javascript.min.js"></script>
    <script src="../../../assets/xml.min.js"></script>
    <script src="../../../assets/css.min.js"></script>
    <script src="../../../assets/bash.min.js"></script>
    <script src="../../../assets/sql.min.js"></script>
</head>

<body>
    <!-- 顶部导航栏 -->
    <div class="top-navbar">
        <div class="site-title">Technology</div>
    </div>

    <!-- 侧边导航栏 -->
    <div class="sidebar">
        <ul class="nav-tree">
            <li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/index.html" class="nav-link-text" data-path="html/java/index.html">java</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/Java并发编程/index.html" class="nav-link-text" data-path="html/java/Java并发编程/index.html">Java并发编程</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java并发编程/Java内存模型(JMM).html" class="nav-link-text" data-path="html/java/Java并发编程/Java内存模型(JMM).html">Java内存模型(JMM)</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java并发编程/线程(Thread).html" class="nav-link-text" data-path="html/java/Java并发编程/线程(Thread).html">线程(Thread)</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/index.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/index.html">Java虚拟机模型(JVM)</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/内存分析工具.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/内存分析工具.html">内存分析工具</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/垃圾回收机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/垃圾回收机制.html">垃圾回收机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/index.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/index.html">字节码分析</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-Lambda表达式.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-Lambda表达式.html">字节码分析-Lambda表达式</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-内部类.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-内部类.html">字节码分析-内部类</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-可变参数.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-可变参数.html">字节码分析-可变参数</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-同步.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-同步.html">字节码分析-同步</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-字段.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-字段.html">字节码分析-字段</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-异常处理.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-异常处理.html">字节码分析-异常处理</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-控制流.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-控制流.html">字节码分析-控制流</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法.html">字节码分析-方法</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法引用.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法引用.html">字节码分析-方法引用</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-泛型.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-泛型.html">字节码分析-泛型</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-类加载机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-类加载机制.html">字节码分析-类加载机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-继承.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-继承.html">字节码分析-继承</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码增强技术.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码增强技术.html">字节码增强技术</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/常量池.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/常量池.html">常量池</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/类加载机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/类加载机制.html">类加载机制</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../html/spring/index.html" class="nav-link-text" data-path="html/spring/index.html">spring</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-boot/index.html" class="nav-link-text" data-path="html/spring/spring-boot/index.html">spring-boot</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot事件机制.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot事件机制.html">SpringBoot事件机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot启动流程.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot启动流程.html">SpringBoot启动流程</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot日志体系.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot日志体系.html">SpringBoot日志体系</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot自动装配.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot自动装配.html">SpringBoot自动装配</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-framework/index.html" class="nav-link-text" data-path="html/spring/spring-framework/index.html">spring-framework</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-framework/BeanDefinition创建流程.html" class="nav-link-text" data-path="html/spring/spring-framework/BeanDefinition创建流程.html">BeanDefinition创建流程</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-framework/BeanLifecycle.html" class="nav-link-text" data-path="html/spring/spring-framework/BeanLifecycle.html">BeanLifecycle</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-framework/Bean创建流程.html" class="nav-link-text" data-path="html/spring/spring-framework/Bean创建流程.html">Bean创建流程</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/index.html">spring-mysql</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/mybatis/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/index.html">mybatis</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis/Mapper源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/Mapper源码分析.html">Mapper源码分析</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/index.html">mybatis-plus</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/DataSource源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/DataSource源码分析.html">DataSource源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/Mapper源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/Mapper源码分析.html">Mapper源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/SQL执行源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL执行源码分析.html">SQL执行源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/SQL模板注册源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL模板注册源码分析.html">SQL模板注册源码分析</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../html/spring/spring启动源码分析/index.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/index.html">spring启动源码分析</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.cancelRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.cancelRefresh.html">AbstractApplicationContext.cancelRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.destroyBeans.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.destroyBeans.html">AbstractApplicationContext.destroyBeans</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.finishBeanFactoryInitialization.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.finishBeanFactoryInitialization.html">AbstractApplicationContext.finishBeanFactoryInitialization</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link active">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.finishRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.finishRefresh.html">AbstractApplicationContext.finishRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.initApplicationEventMulticaster.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.initApplicationEventMulticaster.html">AbstractApplicationContext.initApplicationEventMulticaster</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.initMessageSource.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.initMessageSource.html">AbstractApplicationContext.initMessageSource</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html">AbstractApplicationContext.invokeBeanFactoryPostProcessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.obtainFreshBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.obtainFreshBeanFactory.html">AbstractApplicationContext.obtainFreshBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.onRefresh.html">AbstractApplicationContext.onRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.postProcessBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.postProcessBeanFactory.html">AbstractApplicationContext.postProcessBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.prepareBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.prepareBeanFactory.html">AbstractApplicationContext.prepareBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.prepareRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.prepareRefresh.html">AbstractApplicationContext.prepareRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.registerBeanPostProcessors.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.registerBeanPostProcessors.html">AbstractApplicationContext.registerBeanPostProcessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.registerListeners.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.registerListeners.html">AbstractApplicationContext.registerListeners</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.resetCommonCaches.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.resetCommonCaches.html">AbstractApplicationContext.resetCommonCaches</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.createApplicationContext.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.createApplicationContext.html">Application.createApplicationContext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.refreshContext.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.refreshContext.html">Application.refreshContext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.run.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.run.html">Application.run</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AutoConfigurationImportSelector.getAutoConfigurationEntry.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AutoConfigurationImportSelector.getAutoConfigurationEntry.html">AutoConfigurationImportSelector.getAutoConfigurationEntry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ClassPathMapperScanner.scan.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ClassPathMapperScanner.scan.html">ClassPathMapperScanner.scan</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ConfigurationClassParser.parse.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ConfigurationClassParser.parse.html">ConfigurationClassParser.parse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html">ConfigurationClassPostProcessor.processConfigBeanDefinitions</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html">MapperScannerConfigurer.postProcessBeanDefinitionRegistry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ServletWebServerApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ServletWebServerApplicationContext.onRefresh.html">ServletWebServerApplicationContext.onRefresh</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/云原生/index.html" class="nav-link-text" data-path="html/云原生/index.html">云原生</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/云原生/docker/index.html" class="nav-link-text" data-path="html/云原生/docker/index.html">docker</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/云原生/k8s/index.html" class="nav-link-text" data-path="html/云原生/k8s/index.html">k8s</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/云原生/k8s/K8S网络架构.html" class="nav-link-text" data-path="html/云原生/k8s/K8S网络架构.html">K8S网络架构</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/中间件/index.html" class="nav-link-text" data-path="html/中间件/index.html">中间件</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/clickhouse/index.html" class="nav-link-text" data-path="html/中间件/clickhouse/index.html">clickhouse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/elasticsearch/index.html" class="nav-link-text" data-path="html/中间件/elasticsearch/index.html">elasticsearch</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/kakfa/index.html" class="nav-link-text" data-path="html/中间件/kakfa/index.html">kakfa</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/mongodb/index.html" class="nav-link-text" data-path="html/中间件/mongodb/index.html">mongodb</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/rabbitmq/index.html" class="nav-link-text" data-path="html/中间件/rabbitmq/index.html">rabbitmq</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/redis/index.html" class="nav-link-text" data-path="html/中间件/redis/index.html">redis</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/监控/index.html" class="nav-link-text" data-path="html/监控/index.html">监控</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/监控/prometheus/index.html" class="nav-link-text" data-path="html/监控/prometheus/index.html">prometheus</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/基础/index.html" class="nav-link-text" data-path="html/基础/index.html">基础</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/数据结构/index.html" class="nav-link-text" data-path="html/基础/数据结构/index.html">数据结构</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/画图/index.html" class="nav-link-text" data-path="html/基础/画图/index.html">画图</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/算法/index.html" class="nav-link-text" data-path="html/基础/算法/index.html">算法</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/设计模式/index.html" class="nav-link-text" data-path="html/基础/设计模式/index.html">设计模式</a>
</div>
</li>
</ul>
</li>
        </ul>
    </div>

    <!-- 主内容区 -->
    <div class="main-content">
        <div class="content-body">
            <h2 id="_1">简述</h2>
<p>完成ApplicationContext的刷新过程，发布相应的事件。</p>
<p>这是refresh()方法的第12步，也是正常流程的最后一步。在这一步中：<br/>
- 清理资源缓存<br/>
- 初始化生命周期处理器<br/>
- 调用生命周期处理器的onRefresh方法（<strong>WebServer在这里启动</strong>）<br/>
- 发布ContextRefreshedEvent事件<br/>
- 注册到JMX MBeanServer（如果需要）</p>
<h2 id="_2">核心流程</h2>
<ol>
<li>清理资源缓存（ResourceLoader的缓存）</li>
<li>初始化LifecycleProcessor（生命周期处理器）</li>
<li>调用LifecycleProcessor.onRefresh()方法，启动Lifecycle Bean</li>
<li>发布ContextRefreshedEvent事件</li>
<li>注册ApplicationContext到LiveBeansView MBean</li>
</ol>
<h2 id="_3">源码分析</h2>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AbstractApplicationContext</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">DefaultResourceLoader</span>
<span class="w">        </span><span class="kd">implements</span><span class="w"> </span><span class="n">ConfigurableApplicationContext</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refresh</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">,</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">startupShutdownMonitor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// ... 前面的步骤</span>

<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// ... 其他步骤</span>

<span class="w">                </span><span class="c1">// 完成刷新，发布相应事件</span>
<span class="w">                </span><span class="n">finishRefresh</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// 异常处理</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">finishRefresh</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 1. 清理资源缓存（例如ASM元数据和扫描包的缓存）</span>
<span class="w">        </span><span class="n">clearResourceCaches</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 2. 初始化生命周期处理器</span>
<span class="w">        </span><span class="c1">// 如果容器中有名为"lifecycleProcessor"的Bean就使用它</span>
<span class="w">        </span><span class="c1">// 否则创建默认的DefaultLifecycleProcessor</span>
<span class="w">        </span><span class="n">initLifecycleProcessor</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 3. 调用生命周期处理器的onRefresh方法</span>
<span class="w">        </span><span class="c1">// 这会启动所有实现了Lifecycle接口且设置了autoStartup=true的Bean</span>
<span class="w">        </span><span class="c1">// WebServer就是在这里启动的！</span>
<span class="w">        </span><span class="n">getLifecycleProcessor</span><span class="p">().</span><span class="na">onRefresh</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 4. 发布ContextRefreshedEvent事件</span>
<span class="w">        </span><span class="c1">// 监听此事件的Bean会收到通知</span>
<span class="w">        </span><span class="n">publishEvent</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ContextRefreshedEvent</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>

<span class="w">        </span><span class="c1">// 5. 注册到LiveBeansView MBean（用于JMX管理）</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">NativeDetector</span><span class="p">.</span><span class="na">inNativeImage</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">LiveBeansView</span><span class="p">.</span><span class="na">registerApplicationContext</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">clearResourceCaches</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">resourceCaches</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initLifecycleProcessor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBeanFactory</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsLocalBean</span><span class="p">(</span><span class="n">LIFECYCLE_PROCESSOR_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">lifecycleProcessor</span><span class="w"> </span><span class="o">=</span>
<span class="w">                    </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">LIFECYCLE_PROCESSOR_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">LifecycleProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">DefaultLifecycleProcessor</span><span class="w"> </span><span class="n">defaultProcessor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultLifecycleProcessor</span><span class="p">();</span>
<span class="w">            </span><span class="n">defaultProcessor</span><span class="p">.</span><span class="na">setBeanFactory</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">lifecycleProcessor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">defaultProcessor</span><span class="p">;</span>
<span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerSingleton</span><span class="p">(</span><span class="n">LIFECYCLE_PROCESSOR_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">lifecycleProcessor</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="lifecycleprocessor">LifecycleProcessor详解</h2>
<p>LifecycleProcessor负责管理实现了Lifecycle接口的Bean的生命周期：</p>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Lifecycle</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">();</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">();</span>
<span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isRunning</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">LifecycleProcessor</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Lifecycle</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">onRefresh</span><span class="p">();</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">onClose</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>DefaultLifecycleProcessor的实现：</p>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DefaultLifecycleProcessor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">LifecycleProcessor</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onRefresh</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">startBeans</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">running</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">startBeans</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">autoStartupOnly</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 获取所有Lifecycle Bean</span>
<span class="w">        </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Lifecycle</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lifecycleBeans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getLifecycleBeans</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 按阶段（phase）分组</span>
<span class="w">        </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="p">,</span><span class="w"> </span><span class="n">LifecycleGroup</span><span class="o">&gt;</span><span class="w"> </span><span class="n">phases</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TreeMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="n">lifecycleBeans</span><span class="p">.</span><span class="na">forEach</span><span class="p">((</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">bean</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">autoStartupOnly</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">bean</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">SmartLifecycle</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">                    </span><span class="p">((</span><span class="n">SmartLifecycle</span><span class="p">)</span><span class="w"> </span><span class="n">bean</span><span class="p">).</span><span class="na">isAutoStartup</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">phase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getPhase</span><span class="p">(</span><span class="n">bean</span><span class="p">);</span>
<span class="w">                </span><span class="n">phases</span><span class="p">.</span><span class="na">computeIfAbsent</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LifecycleGroup</span><span class="p">(...))</span>
<span class="w">                      </span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">bean</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="c1">// 按阶段顺序启动</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">phases</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">phases</span><span class="p">.</span><span class="na">values</span><span class="p">().</span><span class="na">forEach</span><span class="p">(</span><span class="n">LifecycleGroup</span><span class="p">::</span><span class="n">start</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="webserver">WebServer在这里启动</h2>
<p>SpringBoot的WebServer实现了SmartLifecycle接口，因此在finishRefresh阶段会被自动启动：</p>
<div class="hljs"><pre><span></span><code><span class="c1">// WebServerStartStopLifecycle是在onRefresh()阶段创建并注册的</span>
<span class="kd">class</span> <span class="nc">WebServerStartStopLifecycle</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">SmartLifecycle</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ServletWebServerApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">WebServer</span><span class="w"> </span><span class="n">webServer</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 启动WebServer（Tomcat、Jetty或Undertow）</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">webServer</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// 发布ServletWebServerInitializedEvent事件</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">applicationContext</span><span class="p">.</span><span class="na">publishEvent</span><span class="p">(</span>
<span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">ServletWebServerInitializedEvent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">webServer</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">applicationContext</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isAutoStartup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">  </span><span class="c1">// 自动启动</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getPhase</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">MAX_VALUE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// 最后启动</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="smartlifecycle">SmartLifecycle接口</h2>
<p>SmartLifecycle扩展了Lifecycle，提供更精细的控制：</p>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">SmartLifecycle</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Lifecycle</span><span class="p">,</span><span class="w"> </span><span class="n">Phased</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// 是否自动启动（在容器refresh时）</span>
<span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isAutoStartup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 停止回调</span>
<span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="n">Runnable</span><span class="w"> </span><span class="n">callback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">stop</span><span class="p">();</span>
<span class="w">        </span><span class="n">callback</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 启动阶段（数字越小越先启动）</span>
<span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getPhase</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">DEFAULT_PHASE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="phase">启动阶段（Phase）说明</h2>
<p>不同的Lifecycle Bean可以设置不同的phase值来控制启动顺序：</p>
<ul>
<li><strong>负数或较小值</strong>：优先启动</li>
<li><strong>0</strong>：默认值</li>
<li><strong>正数或较大值</strong>：后启动</li>
</ul>
<p>例如：<br/>
- 数据源连接池：phase = -100（先启动）<br/>
- 消息队列消费者：phase = 0（默认）<br/>
- WebServer：phase = Integer.MAX_VALUE - 1（最后启动）</p>
<h2 id="contextrefreshedevent">ContextRefreshedEvent事件</h2>
<p>ContextRefreshedEvent是Spring的内置事件，在ApplicationContext初始化或刷新完成时发布。</p>
<p>监听此事件的常见场景：<br/>
- 缓存预热<br/>
- 数据初始化<br/>
- 定时任务启动<br/>
- 连接池建立</p>
<p>示例：</p>
<div class="hljs"><pre><span></span><code><span class="nd">@Component</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">StartupListener</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ApplicationListener</span><span class="o">&lt;</span><span class="n">ContextRefreshedEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onApplicationEvent</span><span class="p">(</span><span class="n">ContextRefreshedEvent</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 容器启动完成，执行初始化逻辑</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"ApplicationContext已启动完成"</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>或使用注解方式：</p>
<div class="hljs"><pre><span></span><code><span class="nd">@Component</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">StartupHandler</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@EventListener</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">handleContextRefresh</span><span class="p">(</span><span class="n">ContextRefreshedEvent</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 容器启动完成</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="onrefresh">与onRefresh()的区别</h2>
<table>
<thead>
<tr>
<th>方法</th>
<th>时机</th>
<th>用途</th>
<th>典型应用</th>
</tr>
</thead>
<tbody>
<tr>
<td>onRefresh()</td>
<td>Bean实例化之前</td>
<td>创建特殊Bean</td>
<td>创建WebServer实例</td>
</tr>
<tr>
<td>finishRefresh()</td>
<td>Bean实例化之后</td>
<td>启动服务、发布事件</td>
<td>启动WebServer、发布事件</td>
</tr>
</tbody>
</table>
<p>注意：<br/>
- <strong>onRefresh()</strong>：创建WebServer对象（但未启动）<br/>
- <strong>finishRefresh()</strong>：启动WebServer（调用start方法）</p>
<h2 id="_4">参考调用栈</h2>
<div class="hljs"><pre><span></span><code>finishRefresh:883, AbstractApplicationContext (org.springframework.context.support)
refresh:553, AbstractApplicationContext (org.springframework.context.support)
refresh:143, ServletWebServerApplicationContext (org.springframework.boot.web.servlet.context)
refresh:755, SpringApplication (org.springframework.boot)
refreshContext:402, SpringApplication (org.springframework.boot)
run:312, SpringApplication (org.springframework.boot)
</code></pre></div>
<h2 id="webserver_1">WebServer启动调用栈</h2>
<div class="hljs"><pre><span></span><code>start:88, TomcatWebServer (org.springframework.boot.web.embedded.tomcat)
start:197, WebServerStartStopLifecycle (org.springframework.boot.web.servlet.context)
startBeans:177, DefaultLifecycleProcessor (org.springframework.context.support)
onRefresh:137, DefaultLifecycleProcessor (org.springframework.context.support)
finishRefresh:932, AbstractApplicationContext (org.springframework.context.support)
refresh:553, AbstractApplicationContext (org.springframework.context.support)
</code></pre></div>
<h2 id="_5">相关链接</h2>
<ul>
<li><a href="AbstractApplicationContext.onRefresh.html">AbstractApplicationContext.onRefresh</a></li>
<li><a href="ServletWebServerApplicationContext.onRefresh.html">ServletWebServerApplicationContext.onRefresh</a></li>
</ul>
        </div>
    </div>

    <script src="../../../assets/script.js"></script>
    <script>
        // 初始化代码高亮
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        });
    </script>
</body>

</html>