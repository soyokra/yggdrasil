<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>虚拟机栈 - Technology</title>
    <link rel="stylesheet" href="../../../assets/style.css">
    <link rel="stylesheet" href="../../../assets/github.min.css">
    <script src="../../../assets/highlight.min.js"></script>
    <script src="../../../assets/python.min.js"></script>
    <script src="../../../assets/java.min.js"></script>
    <script src="../../../assets/javascript.min.js"></script>
    <script src="../../../assets/xml.min.js"></script>
    <script src="../../../assets/css.min.js"></script>
    <script src="../../../assets/bash.min.js"></script>
    <script src="../../../assets/sql.min.js"></script>
</head>

<body>
    <!-- 顶部导航栏 -->
    <div class="top-navbar">
        <div class="site-title">Technology</div>
    </div>

    <!-- 侧边导航栏 -->
    <div class="sidebar">
        <ul class="nav-tree">
            <li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../html/java/index.html" class="nav-link-text" data-path="html/java/index.html">java</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/Java并发编程/index.html" class="nav-link-text" data-path="html/java/Java并发编程/index.html">Java并发编程</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java并发编程/Java内存模型(JMM).html" class="nav-link-text" data-path="html/java/Java并发编程/Java内存模型(JMM).html">Java内存模型(JMM)</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java并发编程/线程(Thread).html" class="nav-link-text" data-path="html/java/Java并发编程/线程(Thread).html">线程(Thread)</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../html/java/Java虚拟机模型/index.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/index.html">Java虚拟机模型</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/内存分析工具.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/内存分析工具.html">内存分析工具</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/垃圾回收机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/垃圾回收机制.html">垃圾回收机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/堆.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/堆.html">堆</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/index.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/index.html">字节码分析</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-Lambda表达式.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-Lambda表达式.html">字节码分析-Lambda表达式</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-内部类.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-内部类.html">字节码分析-内部类</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-可变参数.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-可变参数.html">字节码分析-可变参数</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-同步.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-同步.html">字节码分析-同步</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-字段.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-字段.html">字节码分析-字段</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-异常处理.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-异常处理.html">字节码分析-异常处理</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-控制流.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-控制流.html">字节码分析-控制流</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-方法.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-方法.html">字节码分析-方法</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-方法引用.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-方法引用.html">字节码分析-方法引用</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-泛型.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-泛型.html">字节码分析-泛型</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-类加载机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-类加载机制.html">字节码分析-类加载机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码分析-继承.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码分析-继承.html">字节码分析-继承</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/字节码分析/字节码增强技术.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/字节码分析/字节码增强技术.html">字节码增强技术</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/执行引擎.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/执行引擎.html">执行引擎</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/方法区.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/方法区.html">方法区</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/类加载机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/类加载机制.html">类加载机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link active">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型/虚拟机栈.html" class="nav-link-text" data-path="html/java/Java虚拟机模型/虚拟机栈.html">虚拟机栈</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/index.html" class="nav-link-text" data-path="html/spring/index.html">spring</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-boot/index.html" class="nav-link-text" data-path="html/spring/spring-boot/index.html">spring-boot</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot事件机制.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot事件机制.html">SpringBoot事件机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot启动流程.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot启动流程.html">SpringBoot启动流程</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot日志体系.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot日志体系.html">SpringBoot日志体系</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot自动装配.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot自动装配.html">SpringBoot自动装配</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-framework/index.html" class="nav-link-text" data-path="html/spring/spring-framework/index.html">spring-framework</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-framework/BeanDefinition创建流程.html" class="nav-link-text" data-path="html/spring/spring-framework/BeanDefinition创建流程.html">BeanDefinition创建流程</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-framework/BeanLifecycle.html" class="nav-link-text" data-path="html/spring/spring-framework/BeanLifecycle.html">BeanLifecycle</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-framework/Bean创建流程.html" class="nav-link-text" data-path="html/spring/spring-framework/Bean创建流程.html">Bean创建流程</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/index.html">spring-mysql</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/mybatis/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/index.html">mybatis</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis/Mapper源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/Mapper源码分析.html">Mapper源码分析</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/index.html">mybatis-plus</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/DataSource源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/DataSource源码分析.html">DataSource源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/Mapper源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/Mapper源码分析.html">Mapper源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/SQL执行源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL执行源码分析.html">SQL执行源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/SQL模板注册源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL模板注册源码分析.html">SQL模板注册源码分析</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring启动源码分析/index.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/index.html">spring启动源码分析</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.cancelRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.cancelRefresh.html">AbstractApplicationContext.cancelRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.destroyBeans.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.destroyBeans.html">AbstractApplicationContext.destroyBeans</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.finishBeanFactoryInitialization.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.finishBeanFactoryInitialization.html">AbstractApplicationContext.finishBeanFactoryInitialization</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.finishRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.finishRefresh.html">AbstractApplicationContext.finishRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.initApplicationEventMulticaster.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.initApplicationEventMulticaster.html">AbstractApplicationContext.initApplicationEventMulticaster</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.initMessageSource.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.initMessageSource.html">AbstractApplicationContext.initMessageSource</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html">AbstractApplicationContext.invokeBeanFactoryPostProcessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.obtainFreshBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.obtainFreshBeanFactory.html">AbstractApplicationContext.obtainFreshBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.onRefresh.html">AbstractApplicationContext.onRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.postProcessBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.postProcessBeanFactory.html">AbstractApplicationContext.postProcessBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.prepareBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.prepareBeanFactory.html">AbstractApplicationContext.prepareBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.prepareRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.prepareRefresh.html">AbstractApplicationContext.prepareRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.registerBeanPostProcessors.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.registerBeanPostProcessors.html">AbstractApplicationContext.registerBeanPostProcessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.registerListeners.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.registerListeners.html">AbstractApplicationContext.registerListeners</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.resetCommonCaches.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.resetCommonCaches.html">AbstractApplicationContext.resetCommonCaches</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.createApplicationContext.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.createApplicationContext.html">Application.createApplicationContext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.refreshContext.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.refreshContext.html">Application.refreshContext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.run.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.run.html">Application.run</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AutoConfigurationImportSelector.getAutoConfigurationEntry.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AutoConfigurationImportSelector.getAutoConfigurationEntry.html">AutoConfigurationImportSelector.getAutoConfigurationEntry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ClassPathMapperScanner.scan.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ClassPathMapperScanner.scan.html">ClassPathMapperScanner.scan</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ConfigurationClassParser.parse.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ConfigurationClassParser.parse.html">ConfigurationClassParser.parse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html">ConfigurationClassPostProcessor.processConfigBeanDefinitions</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html">MapperScannerConfigurer.postProcessBeanDefinitionRegistry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ServletWebServerApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ServletWebServerApplicationContext.onRefresh.html">ServletWebServerApplicationContext.onRefresh</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/云原生/index.html" class="nav-link-text" data-path="html/云原生/index.html">云原生</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/云原生/docker/index.html" class="nav-link-text" data-path="html/云原生/docker/index.html">docker</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/云原生/k8s/index.html" class="nav-link-text" data-path="html/云原生/k8s/index.html">k8s</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/云原生/k8s/K8S网络架构.html" class="nav-link-text" data-path="html/云原生/k8s/K8S网络架构.html">K8S网络架构</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/中间件/index.html" class="nav-link-text" data-path="html/中间件/index.html">中间件</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/clickhouse/index.html" class="nav-link-text" data-path="html/中间件/clickhouse/index.html">clickhouse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/elasticsearch/index.html" class="nav-link-text" data-path="html/中间件/elasticsearch/index.html">elasticsearch</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/kakfa/index.html" class="nav-link-text" data-path="html/中间件/kakfa/index.html">kakfa</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/mongodb/index.html" class="nav-link-text" data-path="html/中间件/mongodb/index.html">mongodb</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/rabbitmq/index.html" class="nav-link-text" data-path="html/中间件/rabbitmq/index.html">rabbitmq</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/中间件/redis/index.html" class="nav-link-text" data-path="html/中间件/redis/index.html">redis</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/监控/index.html" class="nav-link-text" data-path="html/监控/index.html">监控</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/监控/prometheus/index.html" class="nav-link-text" data-path="html/监控/prometheus/index.html">prometheus</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/基础/index.html" class="nav-link-text" data-path="html/基础/index.html">基础</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/数据结构/index.html" class="nav-link-text" data-path="html/基础/数据结构/index.html">数据结构</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/画图/index.html" class="nav-link-text" data-path="html/基础/画图/index.html">画图</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/算法/index.html" class="nav-link-text" data-path="html/基础/算法/index.html">算法</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/基础/设计模式/index.html" class="nav-link-text" data-path="html/基础/设计模式/index.html">设计模式</a>
</div>
</li>
</ul>
</li>
        </ul>
    </div>

    <!-- 主内容区 -->
    <div class="main-content">
        <div class="content-body">
            <h1 id="_1">虚拟机栈</h1>
<p>Java虚拟机通过虚拟机栈的形式运行方法，虚拟机栈是一个后进先出（LIFO）栈结构，对应的是多个方法之间的调用逻辑。</p>
<p>虚拟机栈中的栈帧结构是对应方法内容的结构化设计，栈帧中的局部变量表是数据的“存储”模块，操作数栈是数据的“运算”模块。方法的运行本质是数据处理，也就是存取和运算。</p>
<p>方法调用其他方法，或者成员变量是对象的时候，栈帧存的是符号引用，运行时要转成直接引用，就是动态链接（支持多态），编译时就能确定的是静态链接，如静态方法。</p>
<p>当前方法执行完后，要回到调用者的哪个位置继续执行，需要提供返回地址，返回地址指向的就是当前方法的下一行代码执行的地址</p>
<p><img alt="java_stack.png" src="java_stack.png"/></p>
<h2 id="_2">局部变量表</h2>
<p>局部变量表是一种“数据存储结构”，可以看作一个元素是Slot的列表</p>
<p>局部变量表存储的包括方法的参数和方法声明的局部变量</p>
<p><strong>Slot存储</strong><br/>
局部变量表槽位（Slot） 为基本单位，每个 Slot 占 4 字节；</p>
<p>1 个 Slot 存储：boolean/byte/char/short/int/float/reference/returnAddress；</p>
<p>2 个连续 Slot 存储：long/double（64 位类型）；</p>
<p>局部变量表的大小（Slot 数）由字节码的max_locals属性决定，编译期固定，运行期不可扩容。</p>
<p>对于int 类型，在32位系统占4字节，一个Slot，在64位系统占4字节，使用低4字节，高4字节置 0（HotSpot 内部做了对齐处理），也是一个Slot，</p>
<p>对于long 类型，在32位系统占8字节，两个Slot，在64位系统8字节，使用低4字节，高4字节置 0（HotSpot 内部做了对齐处理），也是两个个Slot，</p>
<p>对于引用类型，在32位系统占4字节，一个Slot，在64位系统占8字节，也是一个Slot</p>
<p>由此可见，所谓Slot是一种固定设计的模式，底层操作系统JVM做了兼容处理</p>
<p>局部变量表不可能存对象本体，逃逸技术用的是标量替换的方式，拆解对象为标量</p>
<p>从局部变量表的特点，int类型会比integer类型开销更低（当然，JVM会有优化，但不可能完全等同效果）</p>
<p><strong>Slot顺序</strong><br/>
实例方法：<br/>
第一个 Slot（index=0）固定存储this引用（指向当前对象），这是 JVM 规范的强制要求；<br/>
从 index=1 开始，按方法参数的声明顺序依次分配 Slot（参数 1→index1，参数 2→index2，依此类推）。</p>
<p>静态方法：<br/>
无this引用，参数从 index=0 开始，按声明顺序分配 Slot。</p>
<p><strong>Slot复用</strong></p>
<div class="hljs"><pre><span></span><code>public void reuseSlot() {
    {
    int x = 10; // 分配index0（假设是静态方法，无this）
    System.out.println(x);
    } // x作用域结束，Slot0可复用

    {
        String y = "test"; // 复用x的Slot0，而非分配index1
        System.out.println(y);
    } // y作用域结束，Slot0可复用

    double z = 3.14; // 占用Slot0、1（复用之前的Slot0，新增Slot1）
}
</code></pre></div>
<p>局部变量表中的引用是 GC Roots（垃圾回收根节点），如果一个大对象的引用变量作用域结束，但它占用的 Slot 未被复用，该引用会一直存在，导致对象无法被 GC；只有 Slot 被新变量复用（覆盖引用），原对象才失去 GC Roots 关联，才有机会被回收。</p>
<p>如果一个局部变量声明了，但是没有赋值，也没有使用，会在编译期间优化掉</p>
<p><img alt="java_stack_slot.png" src="java_stack_slot.png"/></p>
<h2 id="_3">操作数栈</h2>
<p>操作数栈是一种“数据运算结构”</p>
<h3 id="_4">一、操作数栈的大小是「编译期确定」的，且不可动态扩容</h3>
<p>这是操作数栈和普通内存栈（如Java的<code>Stack</code>类）最核心的区别之一：<br/>
- <strong>编译期确定最大深度</strong>：Java代码编译成字节码时，编译器会计算出每个方法执行时操作数栈需要的「最大深度」（字节码中<code>stack=2</code>就是指最大深度为2）；<br/>
- <strong>栈帧创建时一次性分配</strong>：方法调用创建栈帧时，JVM会根据这个预计算的深度，为操作数栈分配连续的内存空间（栈槽，Slot），运行时<strong>不会动态扩容</strong>；<br/>
- <strong>溢出后果</strong>：若运行时操作数栈实际使用深度超过编译期确定的最大值，会直接抛出<code>StackOverflowError</code>（注意：和JVM栈的栈溢出是不同场景，但异常类型相同）。</p>
<p><strong>例子</strong>：</p>
<div class="hljs"><pre><span></span><code><span class="c1">// 编译后字节码中stack=3（因为(1+2)*(3-4)的最大栈深度是3）</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">nestedCalc</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>核心意义</strong>：编译期确定大小避免了运行时的内存扩容开销（如数组扩容的复制操作），保证了栈操作的O(1)性能，也让JVM的内存管理更简单。</p>
<h3 id="longdouble">二、long/double类型会占用「两个栈槽」，需特殊处理</h3>
<p>操作数栈的基本存储单元是「栈槽（Slot）」，默认每个栈槽占4字节（可存储int/float/引用类型），但：<br/>
- <code>long</code>（8字节）和<code>double</code>（8字节）会占用<strong>两个连续的栈槽</strong>；<br/>
- 操作这类类型时，JVM会一次性操作两个栈槽（入栈时压入两个槽，出栈时弹出两个槽），不允许单独操作其中一个槽；<br/>
- 字节码指令后缀为<code>l</code>（long）/<code>d</code>（double），如<code>lconst_1</code>（long常量1入栈）、<code>dadd</code>（double加法）。</p>
<p><strong>例子（long运算）</strong>：</p>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">longAdd</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1L</span><span class="p">;</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2L</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>核心字节码+栈变化</strong>：</p>
<div class="hljs"><pre><span></span><code><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="n">lconst_1</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="mi">1</span><span class="err">入栈（占用</span><span class="mi">2</span><span class="err">个槽，栈状态：</span><span class="p">[</span><span class="mi">1</span><span class="n">L</span><span class="p">(</span><span class="err">槽</span><span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span><span class="err">）</span>
<span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">lstore_0</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">弹出</span><span class="mi">1</span><span class="n">L</span><span class="err">，存入局部变量表</span><span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="err">（</span><span class="n">long占两个局部变量槽</span><span class="err">）</span>
<span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">lconst_2</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="mi">2</span><span class="err">入栈（栈状态：</span><span class="p">[</span><span class="mi">2</span><span class="n">L</span><span class="p">(</span><span class="err">槽</span><span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span><span class="err">）</span>
<span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="n">lstore_2</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">弹出</span><span class="mi">2</span><span class="n">L</span><span class="err">，存入局部变量表</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span>
<span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="n">lload_0</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="mi">1</span><span class="n">L从局部变量表压入栈</span><span class="err">（栈：</span><span class="p">[</span><span class="mi">1</span><span class="n">L</span><span class="p">]</span><span class="err">）</span>
<span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="n">lload_2</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="n">L压入栈</span><span class="err">（栈：</span><span class="p">[</span><span class="mi">1</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="n">L</span><span class="p">]</span><span class="err">）</span>
<span class="mi">6</span><span class="p">:</span><span class="w"> </span><span class="n">ladd</span><span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="err">弹出两个</span><span class="n">long</span><span class="err">，相加得</span><span class="mi">3</span><span class="n">L</span><span class="err">，压回栈（占</span><span class="mi">2</span><span class="err">个槽）</span>
<span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="n">lreturn</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="err">返回</span><span class="mi">3</span><span class="n">L</span>
</code></pre></div>
<p><strong>坑点提醒</strong>：若操作数栈中混合了单槽（int）和双槽（long）类型，JVM会严格校验栈槽的使用，避免“槽错位”导致的数据错误。</p>
<h3 id="_5">三、操作数栈是「值传递」，与局部变量表无引用关联</h3>
<p>操作数栈和局部变量表之间的数据交互（<code>iload</code>/<code>istore</code>）是<strong>复制值</strong>，而非引用：<br/>
- 把局部变量压入栈：是将变量的「值拷贝」到栈槽，栈中修改该值，不会影响局部变量；<br/>
- 把栈顶值存入局部变量：是将栈值的「拷贝」写入局部变量表，原栈值弹出后消失。</p>
<p><strong>例子验证</strong>：</p>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">valueCopy</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// 压栈→修改栈值（仅演示逻辑，实际字节码无法直接修改栈值）</span>
<span class="w">    </span><span class="c1">// 栈：[1] → 假设手动改栈值为10 → 栈：[10]</span>
<span class="w">    </span><span class="c1">// 弹出栈值存入b，a仍为1</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">// 返回1，而非10</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>核心意义</strong>：值传递保证了操作数栈的「独立性」，运算过程中的中间结果不会意外污染局部变量，也简化了JVM的内存管理（无需处理引用依赖）。</p>
<h3 id="jit">四、JIT编译器对操作数栈的「栈折叠优化」（性能核心）</h3>
<p>解释执行时，操作数栈的压栈/出栈是内存操作，性能较低，但JIT编译器会对栈操作做「栈折叠（Stack Collapsing）」优化：<br/>
- <strong>核心逻辑</strong>：消除冗余的压栈/出栈操作，直接将栈操作映射为局部变量或寄存器操作；<br/>
- <strong>例子</strong>：<br/>
  解释执行时的字节码：<code>iload_0 → iload_1 → iadd</code>（压a→压b→相加）；<br/>
  JIT编译后：直接取局部变量表的a和b，在CPU寄存器中相加（<code>add eax, ebx</code>），完全跳过栈操作；<br/>
- <strong>极端情况</strong>：若方法内的运算逻辑简单（如<code>a+b</code>），JIT会把操作数栈的所有操作“折叠”成直接的寄存器运算，栈操作相当于“被优化消失”。</p>
<p><strong>核心意义</strong>：这也是JVM敢用“性能稍低”的栈模型的关键——解释执行保证跨平台，JIT的栈折叠则把性能拉回硬件寄存器级别。</p>
<h3 id="dupswap">五、特殊指令：dup/swap（操作数栈的“辅助操作”）</h3>
<p>JVM提供了专门操作栈顶元素的指令，用于处理“重复使用操作数”或“调整操作数顺序”的场景，核心是：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>作用</th>
<th>例子（栈状态变化）</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dup</code></td>
<td>复制栈顶元素，压回栈</td>
<td>栈：[1] → dup → [1, 1]</td>
</tr>
<tr>
<td><code>dup_x1</code></td>
<td>复制栈顶元素，插入到栈顶第二个元素下方</td>
<td>栈：[a, b] → dup_x1 → [b, a, b]</td>
</tr>
<tr>
<td><code>swap</code></td>
<td>交换栈顶两个元素（仅支持单槽类型）</td>
<td>栈：[1, 2] → swap → [2, 1]</td>
</tr>
</tbody>
</table>
<p><strong>典型应用：对象创建+构造方法调用</strong></p>
<div class="hljs"><pre><span></span><code><span class="c1">// new Object()的字节码逻辑</span>
<span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="k">new</span><span class="w">           </span><span class="err">#</span><span class="mi">2</span><span class="w">                  </span><span class="c1">// 创建Object对象，引用压栈：[obj@xxx]</span>
<span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="n">dup</span><span class="w">                               </span><span class="c1">// 复制引用：[obj@xxx, obj@xxx]</span>
<span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="n">invokespecial</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span><span class="w">                  </span><span class="c1">// 弹出一个引用，调用构造方法，栈剩余：[obj@xxx]</span>
<span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="n">astore_0</span><span class="w">                          </span><span class="c1">// 弹出引用，存入局部变量表</span>
</code></pre></div>
<p><strong>为什么需要dup</strong>：<code>new</code>指令创建对象后，引用压栈；构造方法（<code>invokespecial</code>）会弹出引用执行初始化，若不复制，初始化后栈中就没有对象引用了——<code>dup</code>保证了“初始化后仍能拿到对象引用”。</p>
<h3 id="_6">六、操作数栈的「线程私有性」与异常处理</h3>
<ol>
<li><strong>线程私有</strong>：每个线程有独立的JVM栈，每个栈帧的操作数栈也是线程私有的，不存在多线程竞争问题，天然线程安全；</li>
<li><strong>异常时的栈清理</strong>：当方法抛出未捕获的异常时，JVM会销毁当前栈帧，同时清理操作数栈的内存（栈槽的值被置空），避免内存泄漏；</li>
<li><strong>异常表与栈状态</strong>：字节码的异常表会记录“异常处理的起始/结束位置”，JVM跳转到异常处理代码时，会保证操作数栈的状态符合处理代码的要求（如仅保留异常对象的引用）。</li>
</ol>
<h3 id="_7">七、代码运行示例</h3>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">StackOperandTest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">add</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">   </span><span class="c1">// 局部变量表索引0</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">   </span><span class="c1">// 局部变量表索引1</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="hljs"><pre><span></span><code><span class="w">  </span><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">add</span><span class="p">();</span>
<span class="w">    </span><span class="n">Code</span><span class="p">:</span>
<span class="w">      </span><span class="n">stack</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">locals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">args_size</span><span class="o">=</span><span class="mi">0</span>
<span class="w">         </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="n">iconst_1</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">把常量</span><span class="mi">1</span><span class="err">压入栈</span>
<span class="w">         </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">istore_0</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">弹出栈顶</span><span class="mi">1</span><span class="err">，存入局部变量表索引</span><span class="mi">0</span><span class="err">（</span><span class="n">a</span><span class="err">）</span>
<span class="w">         </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">iconst_1</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">把常量</span><span class="mi">1</span><span class="err">压入栈</span>
<span class="w">         </span><span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="n">istore_1</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="err">弹出栈顶</span><span class="mi">1</span><span class="err">，存入局部变量表索引</span><span class="mi">1</span><span class="err">（</span><span class="n">b</span><span class="err">）</span>
<span class="w">         </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="n">iload_0</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="err">把局部变量表</span><span class="mi">0</span><span class="err">的</span><span class="mi">1</span><span class="err">压入栈</span>
<span class="w">         </span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="n">iload_1</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="err">把局部变量表</span><span class="mi">1</span><span class="err">的</span><span class="mi">1</span><span class="err">压入栈</span>
<span class="w">         </span><span class="mi">6</span><span class="p">:</span><span class="w"> </span><span class="n">iadd</span><span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="err">弹出栈顶两个</span><span class="mi">1</span><span class="err">，相加后压回</span><span class="mi">2</span>
<span class="w">         </span><span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="n">ireturn</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="err">弹出栈顶</span><span class="mi">2</span><span class="err">，作为返回值</span>
</code></pre></div>
<h2 id="_8">动态链接</h2>
<h3 id="_9">符号引和直接引用：</h3>
<div class="hljs"><pre><span></span><code>- 符号引用：Class文件中存储的是“符号形式”的引用（比如方法名、类名、字段名的字符串描述，例如`com.example.Animal.eat()`），它不指向内存中的实际地址，只是一个“标识”；
- 直接引用：指向内存中实际地址的引用（比如指向方法区中方法字节码的指针、内存偏移量），是可以直接使用的“物理地址”。
</code></pre></div>
<h3 id="_10">动态链接是什么</h3>
<p>动态链接（也叫“运行时常量池的解析”）是指：<strong>栈帧中会保存一个指向运行时常量池中当前方法的符号引用，在方法执行过程中（尤其是调用其他方法时），JVM会将这个符号引用实时解析为直接引用的过程</strong>。</p>
<p>简单来说：动态链接就是“运行时把‘符号名字’换成‘实际内存地址’”的过程。</p>
<p>Java是面向对象的语言，核心特性之一是<strong>多态（动态分派）</strong>，而动态链接正是支撑多态的关键机制。</p>
<h4 id="_11">静态链接和动态链接</h4>
<p>JVM的方法引用解析分为两种：</p>
<table>
<thead>
<tr>
<th>特性</th>
<th>静态链接（早期解析）</th>
<th>动态链接（晚期解析）</th>
</tr>
</thead>
<tbody>
<tr>
<td>解析时机</td>
<td>类加载的“解析阶段”（类初始化前）</td>
<td>方法<strong>第一次被调用时</strong>（运行时）</td>
</tr>
<tr>
<td>适用方法</td>
<td>非虚方法（静态方法、私有方法、final方法、构造方法）</td>
<td>虚方法（普通成员方法、接口方法）</td>
</tr>
<tr>
<td>绑定方式</td>
<td>编译时绑定（静态分派）</td>
<td>运行时绑定（动态分派）</td>
</tr>
<tr>
<td>核心目的</td>
<td>提前解析，提升执行效率</td>
<td>支持多态，动态确定调用目标</td>
</tr>
</tbody>
</table>
<div class="hljs"><pre><span></span><code><span class="c1">// 父类</span>
<span class="kd">class</span> <span class="nc">Animal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"动物吃饭"</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 子类</span>
<span class="kd">class</span> <span class="nc">Cat</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"猫吃小鱼干"</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Test</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Animal</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Cat</span><span class="p">();</span>
<span class="w">        </span><span class="n">a</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span><span class="w"> </span><span class="c1">// 运行时输出“猫吃小鱼干”</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>编译阶段：编译器只能确定调用的是<code>Animal.eat()</code>的<strong>符号引用</strong>（因为编译时无法知道<code>a</code>实际指向<code>Cat</code>），字节码中会生成<code>invokevirtual</code>指令，指向这个符号引用；</li>
<li>运行阶段：当执行<code>a.eat()</code>时，JVM通过<strong>动态链接</strong>，将<code>Animal.eat()</code>的符号引用解析为<code>Cat.eat()</code>的直接引用（指向内存中<code>Cat</code>类<code>eat</code>方法的实际地址），最终执行子类的方法——这就是动态链接支撑多态的过程。</li>
</ul>
<h3 id="_12">动态链接的实现细节</h3>
<ol>
<li><strong>解析过程</strong>：<ul>
<li>当执行到方法调用指令（如<code>invokevirtual</code>、<code>invokeinterface</code>）时，JVM先检查该符号引用是否已解析为直接引用；</li>
<li>如果未解析：从运行时常量池中找到该符号引用对应的类/方法，验证访问权限后，将其解析为直接引用，并<strong>缓存</strong>（后续调用无需重复解析）；</li>
<li>如果已解析：直接使用缓存的直接引用执行方法。</li>
</ul>
</li>
<li><strong>线程安全性</strong>：动态链接是线程私有的（因为虚拟机栈是线程私有），不同线程解析同一个符号引用不会互相干扰，无需加锁。</li>
<li><strong>缓存机制</strong>：解析后的直接引用会缓存到运行时常量池的对应条目里，避免每次调用都重复解析，平衡“动态性”和“执行效率”。</li>
</ol>
<h3 id="_13">动态链接的特点</h3>
<ol>
<li><strong>延迟解析</strong>：不是类加载时一次性解析所有符号引用，而是“用的时候才解析”，符合Java“懒加载”的设计思想；</li>
<li><strong>动态绑定</strong>：运行时才确定最终调用的方法，是多态的底层核心；</li>
<li><strong>效率平衡</strong>：首次解析有轻微开销，但缓存机制保证后续调用无额外成本。</li>
</ol>
<h2 id="_14">返回地址</h2>
<p>TODO</p>
<h2 id="_15">虚拟机栈执行流程</h2>
<h3 id="java">java代码</h3>
<div class="hljs"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">StackTest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">StackTest</span><span class="w"> </span><span class="n">stackTest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StackTest</span><span class="p">();</span>
<span class="w">        </span><span class="n">stackTest</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="_16">字节码</h3>
<div class="hljs"><pre><span></span><code><span class="w">  </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">run</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="p">);</span>
<span class="w">    </span><span class="n">descriptor</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="n">I</span>
<span class="w">    </span><span class="n">flags</span><span class="p">:</span><span class="w"> </span><span class="n">ACC_PUBLIC</span>
<span class="w">    </span><span class="n">Code</span><span class="p">:</span>
<span class="w">      </span><span class="n">stack</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">locals</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">args_size</span><span class="o">=</span><span class="mi">2</span>
<span class="w">         </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="n">iconst_1</span>
<span class="w">         </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">istore_2</span>
<span class="w">         </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">iconst_2</span>
<span class="w">         </span><span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="n">istore_3</span>
<span class="w">         </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="n">iload_2</span>
<span class="w">         </span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="n">iload_3</span>
<span class="w">         </span><span class="mi">6</span><span class="p">:</span><span class="w"> </span><span class="n">iadd</span>
<span class="w">         </span><span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="n">istore</span><span class="w">        </span><span class="mi">4</span>
<span class="w">         </span><span class="mi">9</span><span class="p">:</span><span class="w"> </span><span class="n">aload_0</span>
<span class="w">        </span><span class="mi">10</span><span class="p">:</span><span class="w"> </span><span class="n">iload</span><span class="w">         </span><span class="mi">4</span>
<span class="w">        </span><span class="mi">12</span><span class="p">:</span><span class="w"> </span><span class="n">iload_1</span>
<span class="w">        </span><span class="mi">13</span><span class="p">:</span><span class="w"> </span><span class="n">invokevirtual</span><span class="w"> </span><span class="c1">#5                  // Method add:(II)I</span>
<span class="w">        </span><span class="mi">16</span><span class="p">:</span><span class="w"> </span><span class="n">istore</span><span class="w">        </span><span class="mi">5</span>
<span class="w">        </span><span class="mi">18</span><span class="p">:</span><span class="w"> </span><span class="n">iload</span><span class="w">         </span><span class="mi">5</span>
<span class="w">        </span><span class="mi">20</span><span class="p">:</span><span class="w"> </span><span class="n">ireturn</span>
<span class="w">      </span><span class="n">LineNumberTable</span><span class="p">:</span>
<span class="w">        </span><span class="n">line</span><span class="w"> </span><span class="mi">10</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">line</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="n">line</span><span class="w"> </span><span class="mi">12</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="n">line</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span>
<span class="w">        </span><span class="n">line</span><span class="w"> </span><span class="mi">14</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span>
<span class="w">      </span><span class="n">LocalVariableTable</span><span class="p">:</span>
<span class="w">        </span><span class="n">Start</span><span class="w">  </span><span class="n">Length</span><span class="w">  </span><span class="n">Slot</span><span class="w">  </span><span class="n">Name</span><span class="w">   </span><span class="n">Signature</span>
<span class="w">            </span><span class="mi">0</span><span class="w">      </span><span class="mi">21</span><span class="w">     </span><span class="mi">0</span><span class="w">  </span><span class="n">this</span><span class="w">   </span><span class="n">Lcom</span><span class="o">/</span><span class="n">yggdrasil</span><span class="o">/</span><span class="n">learn</span><span class="o">/</span><span class="n">stack</span><span class="o">/</span><span class="n">StackTest</span><span class="p">;</span>
<span class="w">            </span><span class="mi">0</span><span class="w">      </span><span class="mi">21</span><span class="w">     </span><span class="mi">1</span><span class="w">     </span><span class="n">d</span><span class="w">   </span><span class="n">I</span>
<span class="w">            </span><span class="mi">2</span><span class="w">      </span><span class="mi">19</span><span class="w">     </span><span class="mi">2</span><span class="w">     </span><span class="n">a</span><span class="w">   </span><span class="n">I</span>
<span class="w">            </span><span class="mi">4</span><span class="w">      </span><span class="mi">17</span><span class="w">     </span><span class="mi">3</span><span class="w">     </span><span class="n">b</span><span class="w">   </span><span class="n">I</span>
<span class="w">            </span><span class="mi">9</span><span class="w">      </span><span class="mi">12</span><span class="w">     </span><span class="mi">4</span><span class="w">     </span><span class="n">c</span><span class="w">   </span><span class="n">I</span>
<span class="w">           </span><span class="mi">18</span><span class="w">       </span><span class="mi">3</span><span class="w">     </span><span class="mi">5</span><span class="w">     </span><span class="n">f</span><span class="w">   </span><span class="n">I</span>
</code></pre></div>
<h3 id="_17">第一步：创建栈栈</h3>
<p>当JVM调用<code>run(int d)</code>方法时，会创建一个栈帧并压入虚拟机栈，这个栈帧的核心组成如下：</p>
<table>
<thead>
<tr>
<th>栈帧组件</th>
<th>具体信息</th>
</tr>
</thead>
<tbody>
<tr>
<td>局部变量表</td>
<td><code>locals=6</code>表示有6个槽位（slot），<code>args_size=2</code>表示方法参数有2个（实例方法默认第一个参数是<code>this</code>，第二个是传入的<code>int d</code>）：<br/>- slot 0：<code>this</code>（当前<code>StackTest</code>实例）<br/>- slot 1：方法参数<code>d</code>（int类型）<br/>- slot 2：局部变量<code>a</code>（int类型）<br/>- slot 3：局部变量<code>b</code>（int类型）<br/>- slot 4：局部变量<code>c</code>（int类型）<br/>- slot 5：局部变量<code>f</code>（int类型）</td>
</tr>
<tr>
<td>操作数栈</td>
<td><code>stack=3</code>表示操作数栈的最大深度为3（执行过程中最多同时存3个操作数），用于临时存放指令的操作数和计算结果</td>
</tr>
<tr>
<td>动态链接</td>
<td>负责将字节码中的“符号引用”（如<code>#5</code>）解析为实际的方法内存地址（本次示例会触发该逻辑）</td>
</tr>
<tr>
<td>方法返回地址</td>
<td>保存调用<code>run(int)</code>方法的代码位置（比如<code>main</code>方法中调用<code>run(10)</code>的下一条指令地址），方法执行完后回到该位置继续执行</td>
</tr>
</tbody>
</table>
<h3 id="_18">第二步：执行指令</h3>
<table>
<thead>
<tr>
<th>指令偏移</th>
<th>指令</th>
<th>操作含义</th>
<th>操作数栈变化</th>
<th>局部变量表变化</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>iconst_1</td>
<td>将常量<code>1</code>压入操作数栈</td>
<td>[] → [1]</td>
<td>无</td>
</tr>
<tr>
<td>1</td>
<td>istore_2</td>
<td>弹出栈顶的<code>1</code>，存入局部变量表slot2（对应变量<code>a</code>）</td>
<td>[1] → []</td>
<td>slot2 = 1（a=1）</td>
</tr>
<tr>
<td>2</td>
<td>iconst_2</td>
<td>将常量<code>2</code>压入操作数栈</td>
<td>[] → [2]</td>
<td>无</td>
</tr>
<tr>
<td>3</td>
<td>istore_3</td>
<td>弹出栈顶的<code>2</code>，存入局部变量表slot3（对应变量<code>b</code>）</td>
<td>[2] → []</td>
<td>slot3 = 2（b=2）</td>
</tr>
<tr>
<td>4</td>
<td>iload_2</td>
<td>从局部变量表slot2取出<code>1</code>（a的值），压入操作数栈</td>
<td>[] → [1]</td>
<td>无</td>
</tr>
<tr>
<td>5</td>
<td>iload_3</td>
<td>从局部变量表slot3取出<code>2</code>（b的值），压入操作数栈</td>
<td>[1] → [1, 2]</td>
<td>无</td>
</tr>
<tr>
<td>6</td>
<td>iadd</td>
<td>弹出栈顶两个int值（1和2），相加得到<code>3</code>，将结果压回操作数栈</td>
<td>[1, 2] → [3]</td>
<td>无</td>
</tr>
<tr>
<td>7</td>
<td>istore        4</td>
<td>弹出栈顶的<code>3</code>，存入局部变量表slot4（对应变量<code>c</code>）<br/>（注：slot≥4时用<code>istore + 偏移</code>格式）</td>
<td>[3] → []</td>
<td>slot4 = 3（c=3）</td>
</tr>
<tr>
<td>9</td>
<td>aload_0</td>
<td>从局部变量表slot0取出<code>this</code>（当前实例），压入操作数栈</td>
<td>[] → [this]</td>
<td>无</td>
</tr>
<tr>
<td>10</td>
<td>iload         4</td>
<td>从局部变量表slot4取出<code>3</code>（c的值），压入操作数栈</td>
<td>[this] → [this, 3]</td>
<td>无</td>
</tr>
<tr>
<td>12</td>
<td>iload_1</td>
<td>从局部变量表slot1取出<code>d</code>（方法传入的参数值，比如调用时传10则取10），压入操作数栈</td>
<td>[this, 3] → [this, 3, d]</td>
<td>无</td>
</tr>
<tr>
<td>13</td>
<td>invokevirtual #5</td>
<td>调用<code>this</code>的<code>add(int, int)</code>方法（参数是3和d）：<br/>1. 弹出栈顶3个值（this、3、d）<br/>2. 执行<code>add</code>方法，得到返回值<code>result</code><br/>3. 将<code>result</code>压入操作数栈</td>
<td>[this, 3, d] → [result]</td>
<td>无</td>
</tr>
<tr>
<td>16</td>
<td>istore        5</td>
<td>弹出栈顶的<code>result</code>，存入局部变量表slot5（对应变量<code>f</code>）</td>
<td>[result] → []</td>
<td>slot5 = result（f=result）</td>
</tr>
<tr>
<td>18</td>
<td>iload         5</td>
<td>从局部变量表slot5取出<code>result</code>（f的值），压入操作数栈</td>
<td>[] → [result]</td>
<td>无</td>
</tr>
<tr>
<td>20</td>
<td>ireturn</td>
<td>弹出栈顶的<code>result</code>作为方法返回值：<br/>1. 销毁当前栈帧<br/>2. 回到调用方的返回地址继续执行</td>
<td>[result] → []（栈帧销毁）</td>
<td>无（栈帧销毁，局部变量表失效）</td>
</tr>
</tbody>
</table>
<h3 id="_19">动态链接</h3>
<p>在指令<code>13: invokevirtual #5</code>中，<code>#5</code>是<strong>符号引用</strong>（指向常量池中的<code>add(II)I</code>方法名），动态链接的工作流程：<br/>
- 栈帧创建时，动态链接组件会关联当前类的常量池；<br/>
- 执行<code>invokevirtual</code>时，动态链接会将符号引用<code>#5</code>解析为<code>add(int, int)</code>方法在内存中的<strong>直接引用</strong>（实际地址）；<br/>
- 解析完成后，JVM才能真正调用到<code>add</code>方法的字节码。</p>
<blockquote>
<p>补充：如果<code>add</code>方法是重写方法（比如子类重写父类的<code>add</code>），动态链接还会在运行时确定具体调用哪个类的<code>add</code>方法（这也是“动态链接”中“动态”的含义）。</p>
</blockquote>
<h3 id="_20">方法返回地址</h3>
<ul>
<li>栈帧创建时，JVM会记录“调用方执行到的指令位置”（比如调用方是<code>main</code>方法，执行<code>int res = stackTest.run(10);</code>时，会记录这条语句的下一条指令地址）；</li>
<li>执行<code>20: ireturn</code>时：<ol>
<li>将返回值（<code>result</code>）传递给调用方（赋值给<code>res</code>）；</li>
<li>销毁<code>run(int)</code>的栈帧（从虚拟机栈弹出）；</li>
<li>根据保存的返回地址，回到<code>main</code>方法的下一条指令继续执行。</li>
</ol>
</li>
</ul>
<h3 id="_21">总结</h3>
<p>简单来说，JVM执行方法的过程，就是栈帧中“局部变量表（存数据）→ 操作数栈（做计算）→ 动态链接（调方法）→ 返回地址（回调用方）”的完整交互过程。</p>
        </div>
    </div>

    <script src="../../../assets/script.js"></script>
    <script>
        // 初始化代码高亮
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        });
    </script>
</body>

</html>