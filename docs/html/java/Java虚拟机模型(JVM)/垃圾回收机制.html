<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>垃圾回收机制 - Technology</title>
    <link rel="stylesheet" href="../../../assets/style.css">
    <link rel="stylesheet" href="../../../assets/github.min.css">
    <script src="../../../assets/highlight.min.js"></script>
    <script src="../../../assets/python.min.js"></script>
    <script src="../../../assets/java.min.js"></script>
    <script src="../../../assets/javascript.min.js"></script>
    <script src="../../../assets/xml.min.js"></script>
    <script src="../../../assets/css.min.js"></script>
    <script src="../../../assets/bash.min.js"></script>
    <script src="../../../assets/sql.min.js"></script>
</head>

<body>
    <!-- 顶部导航栏 -->
    <div class="top-navbar">
        <div class="site-title">Technology</div>
    </div>

    <!-- 侧边导航栏 -->
    <div class="sidebar">
        <ul class="nav-tree">
            <li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../html/java/index.html" class="nav-link-text" data-path="html/java/index.html">java</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/Java并发编程/index.html" class="nav-link-text" data-path="html/java/Java并发编程/index.html">Java并发编程</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java并发编程/Java内存模型(JMM).html" class="nav-link-text" data-path="html/java/Java并发编程/Java内存模型(JMM).html">Java内存模型(JMM)</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java并发编程/线程(Thread).html" class="nav-link-text" data-path="html/java/Java并发编程/线程(Thread).html">线程(Thread)</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children active">
<span class="nav-link-icon expanded" data-toggle="collapse"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/index.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/index.html">Java虚拟机模型(JVM)</a>
</div>
<ul class="nav-children expanded">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/java类加载机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/java类加载机制.html">java类加载机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link active">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/垃圾回收机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/垃圾回收机制.html">垃圾回收机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/index.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/index.html">字节码分析</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-Lambda表达式.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-Lambda表达式.html">字节码分析-Lambda表达式</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-内部类.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-内部类.html">字节码分析-内部类</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-可变参数.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-可变参数.html">字节码分析-可变参数</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-同步.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-同步.html">字节码分析-同步</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-字段.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-字段.html">字节码分析-字段</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-异常处理.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-异常处理.html">字节码分析-异常处理</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-控制流.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-控制流.html">字节码分析-控制流</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法.html">字节码分析-方法</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法引用.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-方法引用.html">字节码分析-方法引用</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-泛型.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-泛型.html">字节码分析-泛型</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-类加载机制.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-类加载机制.html">字节码分析-类加载机制</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-继承.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码分析-继承.html">字节码分析-继承</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/java/Java虚拟机模型(JVM)/字节码分析/字节码增强技术.html" class="nav-link-text" data-path="html/java/Java虚拟机模型(JVM)/字节码分析/字节码增强技术.html">字节码增强技术</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/index.html" class="nav-link-text" data-path="html/spring/index.html">spring</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-boot/index.html" class="nav-link-text" data-path="html/spring/spring-boot/index.html">spring-boot</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/BeanLifecycle.html" class="nav-link-text" data-path="html/spring/spring-boot/BeanLifecycle.html">BeanLifecycle</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot事件流程.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot事件流程.html">SpringBoot事件流程</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot启动流程.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot启动流程.html">SpringBoot启动流程</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-boot/SpringBoot自动装配.html" class="nav-link-text" data-path="html/spring/spring-boot/SpringBoot自动装配.html">SpringBoot自动装配</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-framework/index.html" class="nav-link-text" data-path="html/spring/spring-framework/index.html">spring-framework</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/index.html">spring-mysql</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/mybatis/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/index.html">mybatis</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis/Mapper源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis/Mapper源码分析.html">Mapper源码分析</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/index.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/index.html">mybatis-plus</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/DataSource源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/DataSource源码分析.html">DataSource源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/Mapper源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/Mapper源码分析.html">Mapper源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/SQL执行源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL执行源码分析.html">SQL执行源码分析</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring-mysql/mybatis-plus/SQL模板注册源码分析.html" class="nav-link-text" data-path="html/spring/spring-mysql/mybatis-plus/SQL模板注册源码分析.html">SQL模板注册源码分析</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/spring/spring启动源码分析/index.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/index.html">spring启动源码分析</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.cancelRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.cancelRefresh.html">AbstractApplicationContext.cancelRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.destroyBeans.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.destroyBeans.html">AbstractApplicationContext.destroyBeans</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.finishBeanFactoryInitialization.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.finishBeanFactoryInitialization.html">AbstractApplicationContext.finishBeanFactoryInitialization</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.finishRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.finishRefresh.html">AbstractApplicationContext.finishRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.initApplicationEventMulticaster.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.initApplicationEventMulticaster.html">AbstractApplicationContext.initApplicationEventMulticaster</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.initMessageSource.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.initMessageSource.html">AbstractApplicationContext.initMessageSource</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.invokeBeanFactoryPostProcessors.html">AbstractApplicationContext.invokeBeanFactoryPostProcessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.obtainFreshBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.obtainFreshBeanFactory.html">AbstractApplicationContext.obtainFreshBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.onRefresh.html">AbstractApplicationContext.onRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.postProcessBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.postProcessBeanFactory.html">AbstractApplicationContext.postProcessBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.prepareBeanFactory.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.prepareBeanFactory.html">AbstractApplicationContext.prepareBeanFactory</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.prepareRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.prepareRefresh.html">AbstractApplicationContext.prepareRefresh</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.registerBeanPostProcessors.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.registerBeanPostProcessors.html">AbstractApplicationContext.registerBeanPostProcessors</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.registerListeners.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.registerListeners.html">AbstractApplicationContext.registerListeners</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AbstractApplicationContext.resetCommonCaches.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AbstractApplicationContext.resetCommonCaches.html">AbstractApplicationContext.resetCommonCaches</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.createApplicationContext.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.createApplicationContext.html">Application.createApplicationContext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.refreshContext.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.refreshContext.html">Application.refreshContext</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/Application.run.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/Application.run.html">Application.run</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/AutoConfigurationImportSelector.getAutoConfigurationEntry.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/AutoConfigurationImportSelector.getAutoConfigurationEntry.html">AutoConfigurationImportSelector.getAutoConfigurationEntry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ClassPathMapperScanner.scan.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ClassPathMapperScanner.scan.html">ClassPathMapperScanner.scan</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ConfigurationClassParser.parse.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ConfigurationClassParser.parse.html">ConfigurationClassParser.parse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ConfigurationClassPostProcessor.processConfigBeanDefinitions.html">ConfigurationClassPostProcessor.processConfigBeanDefinitions</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/MapperScannerConfigurer.postProcessBeanDefinitionRegistry.html">MapperScannerConfigurer.postProcessBeanDefinitionRegistry</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/spring/spring启动源码分析/ServletWebServerApplicationContext.onRefresh.html" class="nav-link-text" data-path="html/spring/spring启动源码分析/ServletWebServerApplicationContext.onRefresh.html">ServletWebServerApplicationContext.onRefresh</a>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/cloud/index.html" class="nav-link-text" data-path="html/cloud/index.html">cloud</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/cloud/docker/index.html" class="nav-link-text" data-path="html/cloud/docker/index.html">docker</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/cloud/k8s/index.html" class="nav-link-text" data-path="html/cloud/k8s/index.html">k8s</a>
</div>
</li>
</ul>
</li>
<li class="nav-item">
<div class="nav-link has-children">
<span class="nav-link-icon" data-toggle="collapse"></span>
<a href="../../../html/others/index.html" class="nav-link-text" data-path="html/others/index.html">others</a>
</div>
<ul class="nav-children">
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/algorithm/index.html" class="nav-link-text" data-path="html/others/algorithm/index.html">algorithm</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/clickhouse/index.html" class="nav-link-text" data-path="html/others/clickhouse/index.html">clickhouse</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/data-structure/index.html" class="nav-link-text" data-path="html/others/data-structure/index.html">data-structure</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/design-pattern/index.html" class="nav-link-text" data-path="html/others/design-pattern/index.html">design-pattern</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/diagram/index.html" class="nav-link-text" data-path="html/others/diagram/index.html">diagram</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/elasticsearch/index.html" class="nav-link-text" data-path="html/others/elasticsearch/index.html">elasticsearch</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/kakfa/index.html" class="nav-link-text" data-path="html/others/kakfa/index.html">kakfa</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/mongodb/index.html" class="nav-link-text" data-path="html/others/mongodb/index.html">mongodb</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/prometheus/index.html" class="nav-link-text" data-path="html/others/prometheus/index.html">prometheus</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/rabbitmq/index.html" class="nav-link-text" data-path="html/others/rabbitmq/index.html">rabbitmq</a>
</div>
</li>
<li class="nav-item">
<div class="nav-link">
<span class="nav-link-icon" style="width: 20px; margin-right: 4px;"></span>
<a href="../../../html/others/redis/index.html" class="nav-link-text" data-path="html/others/redis/index.html">redis</a>
</div>
</li>
</ul>
</li>
        </ul>
    </div>

    <!-- 主内容区 -->
    <div class="main-content">
        <div class="content-body">
            <h1 id="_1">垃圾回收机制</h1>
<h2 id="_2">可达性分析</h2>
<p><img alt="reachability_analysis.png" src="reachability_analysis.png"/></p>
<h2 id="gc-root">GC-Root</h2>
<ol>
<li>虚拟机栈中的引用（方法的参数，局部变量等）</li>
<li>本地方法栈中JNI的引用</li>
<li>类静态变量</li>
<li>运行时常量池的常量</li>
</ol>
<h2 id="stwstop-the-world">STW(Stop The World)</h2>
<p>在垃圾收集过程中，JVM 会暂停所有的用户线程，这种暂停被称为"Stop The World"事件</p>
<h2 id="_3">垃圾搜集算法</h2>
<h3 id="_4">标记清除算法</h3>
<p><img alt="mark_sweep.png" src="mark_sweep.png"/></p>
<h3 id="_5">复制算法</h3>
<p><img alt="mark_copy.png" src="mark_copy.png"/></p>
<h3 id="_6">标记整理算法</h3>
<p><img alt="mark_compact.png" src="mark_compact.png"/></p>
<h3 id="_7">分代收集算法</h3>
<p><img alt="generational_collection.png" src="generational_collection.png"/></p>
<h2 id="gc">GC主要场景</h2>
<p>默认空间比例为 8:1:1(Eden区:Survivor 0区:Survivor 1区); 2:1(Eden区+Survivor区: Old区)</p>
<h3 id="_8">常见流程</h3>
<div class="hljs"><pre><span></span><code>第一次：
Eden 区满 → 触发 Minor GC（扫描 Eden 区 + 初始 From 区 S0，S0 为空）→ 存活对象进入当前 To 区 S1（年龄+1）

第二次：
Eden 区满 → 触发 Minor GC（扫描 Eden 区 + 当前 From 区 S1）→ 存活对象进入当前 To 区 S0（年龄+1）

第三次：
Eden 区满 → 触发 Minor GC（扫描 Eden 区 + 当前 From 区 S0）→ 存活对象进入当前 To 区 S1（年龄+1）

...

第 15 次：
Eden 区满 → 触发 Minor GC（扫描 Eden 区 + 对应 From 区）→ 对象年龄达到 15 → 直接晋升 Old 区
</code></pre></div>
<ul>
<li>若某次 Minor GC 后，Survivor To 区放不下所有存活对象（Eden + From 区的存活对象过多），部分对象会「提前晋升老年代」（无需等到 15 次）；</li>
<li>年龄阈值可通过 -XX:MaxTenuringThreshold 调整（不一定是 15，如调整为 10 则 10 次后晋升）</li>
</ul>
<h3 id="_9">大对象</h3>
<div class="hljs"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">大对象创建</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">优先尝试分配到Eden区</span>
<span class="w">   </span><span class="err">├─</span><span class="w"> </span><span class="n">能放下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">分配成功</span><span class="err">，</span><span class="n">流程结束</span>
<span class="w">   </span><span class="err">└─</span><span class="w"> </span><span class="n">放不下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">进入步骤2</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">尝试分配到</span><span class="err">「</span><span class="n">当前空闲的Survivor</span><span class="w"> </span><span class="kr">To</span><span class="n">区</span><span class="err">」（</span><span class="n">可能是S0或S1</span><span class="err">，</span><span class="n">非固定</span><span class="err">）</span>
<span class="w">   </span><span class="err">├─</span><span class="w"> </span><span class="n">能放下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">分配成功</span><span class="err">，</span><span class="n">流程结束</span>
<span class="w">   </span><span class="err">└─</span><span class="w"> </span><span class="n">放不下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">触发Minor</span><span class="w"> </span><span class="n">GC</span><span class="err">（</span><span class="n">步骤3</span><span class="err">）</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">执行Minor</span><span class="w"> </span><span class="n">GC</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">回收Eden区</span><span class="o">+</span><span class="n">当前From区的不可达对象</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">Minor</span><span class="w"> </span><span class="n">GC后</span><span class="err">，</span><span class="n">重新尝试分配</span><span class="err">（</span><span class="n">先Eden</span><span class="err">，</span><span class="n">后To区</span><span class="err">）</span>
<span class="w">   </span><span class="err">├─</span><span class="w"> </span><span class="n">能放下</span><span class="err">（</span><span class="n">Eden或To区</span><span class="err">）</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">分配成功</span><span class="err">，</span><span class="n">流程结束</span>
<span class="w">   </span><span class="err">└─</span><span class="w"> </span><span class="n">仍放不下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">大对象需晋升老年代</span><span class="err">（</span><span class="n">步骤5</span><span class="err">）</span>
<span class="mf">5.</span><span class="w"> </span><span class="n">检查老年代剩余连续空间</span>
<span class="w">   </span><span class="err">├─</span><span class="w"> </span><span class="n">能放下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">晋升老年代</span><span class="err">，</span><span class="n">分配成功</span><span class="err">，</span><span class="n">流程结束</span>
<span class="w">   </span><span class="err">└─</span><span class="w"> </span><span class="n">放不下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">触发Major</span><span class="w"> </span><span class="n">GC</span><span class="o">/</span><span class="n">Full</span><span class="w"> </span><span class="n">GC</span><span class="err">（</span><span class="n">步骤6</span><span class="err">）</span>
<span class="mf">6.</span><span class="w"> </span><span class="n">执行Major</span><span class="w"> </span><span class="n">GC</span><span class="o">/</span><span class="n">Full</span><span class="w"> </span><span class="n">GC</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">回收老年代</span><span class="o">+</span><span class="n">新生代的不可达对象</span>
<span class="mf">7.</span><span class="w"> </span><span class="n">再次检查老年代剩余空间</span>
<span class="w">   </span><span class="err">├─</span><span class="w"> </span><span class="n">能放下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">大对象分配到Old区</span><span class="err">，</span><span class="n">流程结束</span>
<span class="w">   </span><span class="err">└─</span><span class="w"> </span><span class="n">仍放不下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">抛出</span><span class="w"> </span><span class="n">OutOfMemoryError</span><span class="p">:</span><span class="w"> </span><span class="n">Java</span><span class="w"> </span><span class="n">heap</span><span class="w"> </span><span class="n">space</span><span class="err">（</span><span class="n">OOM</span><span class="err">）</span>
</code></pre></div>
<h3 id="pretenuresizethreshold">大对象超过PretenureSizeThreshold</h3>
<div class="hljs"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">大对象创建</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">直接尝试分配到老年代</span>
<span class="w">   </span><span class="err">├─</span><span class="w"> </span><span class="n">能放下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">分配成功</span>
<span class="w">   </span><span class="err">└─</span><span class="w"> </span><span class="n">放不下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">触发Major</span><span class="w"> </span><span class="n">GC</span><span class="o">/</span><span class="n">Full</span><span class="w"> </span><span class="n">GC</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">GC后再次检查老年代空间</span>
<span class="w">   </span><span class="err">├─</span><span class="w"> </span><span class="n">能放下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">分配成功</span>
<span class="w">   </span><span class="err">└─</span><span class="w"> </span><span class="n">放不下</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">OOM</span>
</code></pre></div>
<h3 id="jvm">动态对象年龄判定（JVM 优化：提前晋升的"隐藏规则"）</h3>
<p><strong>触发条件</strong>：Minor GC 后，Survivor 区中「同一年龄的对象总大小」≥ Survivor 区总容量的 50%</p>
<p><strong>流程</strong>：<br/>
1. 示例：Survivor 区总大小 20MB，年龄为 3 的对象总大小达到 10MB（≥50%）<br/>
2. JVM 直接将「年龄 ≥3 的所有对象」提前晋升到老年代（无需等到默认的 15 次）</p>
<p><strong>核心说明</strong>：<br/>
- JVM 自适应优化策略，避免 Survivor 区被"同一年龄段大量对象"占满，导致后续对象无法复制<br/>
- 优先级高于 <code>MaxTenuringThreshold</code> 阈值，即使阈值设为 15，满足条件也会提前晋升</p>
<h3 id="_10">空间分配担保（晋升前的"安全检查"）</h3>
<p><strong>触发条件</strong>：Minor GC 前，JVM 执行「空间分配担保」检查（参数 <code>-XX:+HandlePromotionFailure</code> 开启，JDK8+ 默认）：<br/>
- 检查「老年代最大可用连续空间」是否 ≥「新生代历次晋升到老年代的对象平均大小」<br/>
- 不满足则判定为"担保失败"（认为 GC 后仍可能无法容纳晋升对象）</p>
<p><strong>流程</strong>：<br/>
1. 虚拟机先检查老年代最大可用连续空间是否大于新生代所有对象总空间<br/>
   - 如果大于，Minor GC 可以确保是安全的<br/>
   - 如果不大于，继续下一步检查<br/>
2. 检查老年代最大可用连续空间是否大于历次晋升到老年代对象的平均大小<br/>
   - 如果大于，尝试进行一次 Minor GC（有风险）<br/>
   - 如果小于，或 HandlePromotionFailure 不允许冒险，则改为进行 Full GC<br/>
3. 担保失败 → 直接触发「Full GC」（而非先执行 Minor GC）<br/>
4. Full GC 回收老年代+新生代空间后，再执行 Minor GC，后续按正常逻辑分配/晋升</p>
<p><strong>核心说明</strong>：<br/>
- 避免"Minor GC 后大量对象晋升，老年代仍放不下"导致的二次 Full GC，减少性能抖动<br/>
- 关闭 <code>HandlePromotionFailure</code>（不推荐）会直接抛出 OOM（JDK7 及以前默认关闭，后续已废弃该关闭逻辑）</p>
<h3 id="_11">数组大对象的特殊分配逻辑</h3>
<p><strong>触发条件</strong>：创建「大数组对象」（如 <code>new byte[100MB]</code>），数组元素无外部强引用，但本身占用大量连续内存</p>
<p><strong>特殊点</strong>：<br/>
- 未超过 <code>PretenureSizeThreshold</code> 时本应进入新生代，但数组需连续内存，若 Eden 区剩余空间碎片化（即使总和够），仍判定为"放不下"<br/>
- 直接触发 Minor GC，GC 后仍无法在新生代分配则晋升老年代</p>
<p><strong>核心说明</strong>：<br/>
- 数组对象对"连续内存"要求更高（通常体积更大，更易因碎片导致分配失败）<br/>
- 老年代的标记-整理算法保证连续空间，因此大数组最终更易在老年代分配</p>
<h3 id="minor-gc">Minor GC 时"晋升总大小"超过老年代剩余空间</h3>
<p><strong>触发条件</strong>：Minor GC 后，Eden+From 区的存活对象总大小（需晋升到老年代的部分）＞ 老年代剩余连续空间</p>
<p><strong>流程</strong>：<br/>
1. 直接触发「Full GC」（而非先晋升再判断）<br/>
2. Full GC 回收老年代空间后，重新尝试晋升<br/>
3. 仍不足 → OOM</p>
<p><strong>核心说明</strong>：<br/>
- 区别于"单个大对象晋升"：该场景是「批量存活对象晋升」（如业务高峰期大量短期对象未回收）<br/>
- 是"Minor GC 频繁触发 Full GC"的核心诱因之一，需优化代码减少长期存活对象或调大老年代</p>
<h3 id="minor-gc_1">软引用对象触发的 Minor GC</h3>
<p><strong>触发条件</strong>：软引用关联的对象（非强引用），当「新生代内存不足」（Eden 区即将满）时</p>
<p><strong>流程</strong>：<br/>
1. 软引用对象默认存于新生代，Eden 区满前，JVM 优先回收「仅被软引用关联的对象」<br/>
2. 回收后 Eden 区仍不足 → 触发 Minor GC</p>
<p><strong>核心说明</strong>：<br/>
- 软引用"内存不足时回收"特性仅针对新生代对象，老年代软引用需等到老年代内存不足时回收<br/>
- 常用于缓存场景（图片缓存），避免缓存占用过多新生代内存导致频繁 Minor GC</p>
<h2 id="full-gc">Full GC 触发条件</h2>
<ol>
<li><strong>System.gc() 调用</strong>：此方法建议 JVM 进行 Full GC，虽然不一定立即执行，但大多数情况下会触发</li>
<li>业务代码调用 <code>System.gc()</code>（JVM 仅作"建议"，不保证执行）</li>
<li>多数 JVM 实现会触发「Full GC」（回收新生代+老年代）</li>
<li>开启 <code>-XX:+DisableExplicitGC</code>（推荐生产环境开启）则忽略该调用，不触发 GC</li>
<li>
<p><strong>注意</strong>：不建议业务代码调用，破坏 JVM 自动 GC 策略，导致 Full GC 频繁、性能抖动</p>
</li>
<li>
<p><strong>老年代空间不足</strong>：当老年代空间不足以容纳新晋升的对象或大对象时</p>
</li>
<li>
<p><strong>方法区（PermGen/Metaspace）空间不足</strong>：</p>
</li>
<li>元空间（JDK8+ 替代永久代）存储类元数据（Class 对象、方法信息等）</li>
<li>加载大量类（如 Spring Boot 应用、动态代理类）导致元空间满</li>
<li>手动设置 <code>-XX:MaxMetaspaceSize</code> 后达到阈值（默认无上限，依赖物理内存）</li>
<li>元空间不足 → 触发 Full GC（唯一能回收元空间的 GC 类型）</li>
<li>回收"无用的类元数据"（类加载器被回收、无对象引用的 Class）</li>
<li>
<p>回收后元空间仍不足 → 抛出 <code>OutOfMemoryError: Metaspace</code></p>
</li>
<li>
<p><strong>Minor GC 晋升失败</strong>：通过分配担保机制判断老年代空间不足以应对 Minor GC 的晋升</p>
</li>
<li>
<p><strong>CMS Concurrent Mode Failure</strong>：CMS 垃圾回收期间，用户线程产生的新垃圾（浮动垃圾）导致老年代满，或者老年代碎片过多无法分配大对象</p>
</li>
</ol>
<h2 id="_12">引用类型</h2>
<p>Java 提供了四种引用类型，对 GC 的影响不同：</p>
<ol>
<li><strong>强引用 (Strong Reference)</strong></li>
<li>最常见的引用，如 <code>Object obj = new Object()</code></li>
<li>
<p>只要强引用存在，垃圾收集器永远不会回收掉被引用的对象</p>
</li>
<li>
<p><strong>软引用 (Soft Reference)</strong></p>
</li>
<li>用 <code>SoftReference</code> 类实现</li>
<li>在系统将要发生内存溢出异常之前，会将这些对象列进回收范围进行第二次回收。如果这次回收还没有足够的内存，才会抛出内存溢出异常</li>
<li>适合做缓存</li>
<li>
<p><strong>触发条件</strong>：新生代内存不足时，JVM 优先回收「仅被软引用关联的对象」</p>
</li>
<li>
<p><strong>弱引用 (Weak Reference)</strong></p>
</li>
<li>用 <code>WeakReference</code> 类实现</li>
<li>被弱引用关联的对象只能生存到下一次垃圾收集发生之前。当垃圾收集器工作时，无论当前内存是否足够，都会回收掉只被弱引用关联的对象</li>
<li>适合做缓存（如 WeakHashMap）</li>
<li>
<p><strong>触发条件</strong>：无论内存是否充足，只要触发 GC（Minor/Full），就回收仅被弱引用关联的对象</p>
</li>
<li>
<p><strong>虚引用 (Phantom Reference)</strong></p>
</li>
<li>用 <code>PhantomReference</code> 类实现</li>
<li>一个对象是否有虚引用的存在，完全不会对其生存时间构成影响，也无法通过虚引用来取得一个对象实例</li>
<li>为一个对象设置虚引用关联的唯一目的就是能在这个对象被收集器回收时收到一个系统通知（用于直接内存回收等）</li>
<li><strong>适用场景</strong>：监控对象回收时机（释放 native 资源），不影响 GC 触发，但会被 GC 主动处理，必须配合「引用队列（ReferenceQueue）」</li>
</ol>
<h2 id="_13">方法区回收</h2>
<p>方法区（Java 8 后的 Metaspace）主要回收两部分内容：</p>
<ol>
<li>
<p><strong>废弃的常量</strong>：没有任何地方引用该常量</p>
</li>
<li>
<p><strong>无用的类</strong>（需同时满足以下三个条件）：</p>
</li>
<li>该类所有的实例都已经被回收</li>
<li>加载该类的 ClassLoader 已经被回收</li>
<li>该类对应的 java.lang.Class 对象没有在任何地方被引用，无法在任何地方通过反射访问该类的方法</li>
</ol>
<p><strong>核心说明</strong>：<br/>
- 方法区回收条件苛刻，主要针对动态类加载场景（如动态代理、反射、热部署）<br/>
- 间接影响堆内存：Full GC 同时回收堆内对象，可能导致大对象提前晋升或回收<br/>
- 动态类加载场景需重点关注，易因忽略元空间导致内存泄漏</p>
<h2 id="_14">垃圾收集器简介</h2>
<h3 id="serial">Serial 收集器</h3>
<ul>
<li>单线程收集器，进行垃圾收集时必须暂停其他所有工作线程（STW）。</li>
<li>简单高效，适合 Client 模式。</li>
</ul>
<h3 id="parallel-scavenge">Parallel Scavenge 收集器</h3>
<ul>
<li>新生代收集器，使用复制算法，并行的多线程收集器。</li>
<li>目标是达到一个可控制的吞吐量（Throughput = 运行用户代码时间 / (运行用户代码时间 + 垃圾收集时间)）。</li>
</ul>
<h3 id="cms-concurrent-mark-sweep">CMS (Concurrent Mark Sweep) 收集器</h3>
<ul>
<li>老年代收集器，基于标记-清除算法。</li>
<li>以获取最短回收停顿时间为目标，适合互联网站点。</li>
<li>缺点：对 CPU 资源敏感、无法处理浮动垃圾、产生内存碎片。</li>
</ul>
<h3 id="g1-garbage-first">G1 (Garbage-First) 收集器</h3>
<ul>
<li>面向服务端应用，将堆划分为多个大小相等的 Region</li>
<li>能预测停顿时间，避免全堆扫描</li>
<li>整体看是基于标记-整理算法，局部看是基于复制算法，不会产生内存碎片</li>
<li><strong>特殊分配规则</strong>：<ul>
<li>无固定 Eden/Survivor/Old 区边界（按 Region 划分，Region 可动态切换角色）</li>
<li>大对象（超过 Region 大小 50%）直接分配到「大对象 Region」（属于老年代），无需经过新生代</li>
<li>Minor GC 为"年轻代 Region 回收"，Full GC 为"混合回收"（年轻代+部分老年代 Region）</li>
</ul>
</li>
</ul>
<h3 id="zgc-z-garbage-collector">ZGC (Z Garbage Collector)</h3>
<ul>
<li>JDK 11 引入，可伸缩的低延迟垃圾收集器</li>
<li>目标是将停顿时间控制在 10ms 以内，且不随堆大小增加而增加</li>
<li>基于读屏障、染色指针和内存多重映射等技术</li>
<li><strong>特殊分配规则</strong>：<ul>
<li>全堆无分代（或弱化分代），大对象直接分配到堆中，GC 时通过"并发移动"回收，无需提前晋升</li>
<li>无 Minor/Major GC 区分，统一为"GC 周期"，避免长时间停顿</li>
</ul>
</li>
</ul>
<h2 id="_15">跨代引用与卡表机制</h2>
<p><strong>触发背景</strong>：老年代对象可能引用新生代对象（如老年代静态变量引用新生代对象），Minor GC 需确认老年代是否有引用指向新生代存活对象</p>
<p><strong>特殊处理</strong>：<br/>
- JVM 通过「卡表（Card Table）」标记老年代中"可能有跨代引用"的内存块<br/>
- Minor GC 时仅扫描卡表标记的块，而非全量老年代，提升扫描效率</p>
<p><strong>核心说明</strong>：<br/>
- 不影响对象分配/晋升流程，但优化 Minor GC 执行效率<br/>
- JVM 底层默认开启，无需手动配置</p>
<h2 id="_16">参数配置说明</h2>
<h3 id="_17">堆内存配置</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-Xms</code></td>
<td>初始堆大小</td>
<td><code>-Xms2g</code> 设置初始堆为2GB</td>
</tr>
<tr>
<td><code>-Xmx</code></td>
<td>最大堆大小</td>
<td><code>-Xmx4g</code> 设置最大堆为4GB</td>
</tr>
<tr>
<td><code>-Xmn</code></td>
<td>新生代大小</td>
<td><code>-Xmn1g</code> 设置新生代为1GB</td>
</tr>
<tr>
<td><code>-XX:NewRatio</code></td>
<td>老年代/新生代比例</td>
<td><code>-XX:NewRatio=2</code> 老年代是新生代的2倍</td>
</tr>
<tr>
<td><code>-XX:SurvivorRatio</code></td>
<td>Eden/Survivor比例</td>
<td><code>-XX:SurvivorRatio=8</code> Eden是单个Survivor的8倍（默认8:1:1）</td>
</tr>
</tbody>
</table>
<p><strong>推荐配置</strong>：<br/>
- 生产环境建议 <code>-Xms</code> 和 <code>-Xmx</code> 设置相同值，避免运行时动态扩容导致性能抖动<br/>
- 堆内存通常设置为物理内存的 60%-80%</p>
<h3 id="_18">对象晋升配置</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-XX:MaxTenuringThreshold</code></td>
<td>对象晋升老年代的年龄阈值</td>
<td><code>-XX:MaxTenuringThreshold=15</code> 默认15次</td>
</tr>
<tr>
<td><code>-XX:PretenureSizeThreshold</code></td>
<td>大对象直接进入老年代的阈值</td>
<td><code>-XX:PretenureSizeThreshold=1048576</code> 超过1MB直接进老年代</td>
</tr>
<tr>
<td><code>-XX:TargetSurvivorRatio</code></td>
<td>Survivor区目标使用率</td>
<td><code>-XX:TargetSurvivorRatio=50</code> 默认50%</td>
</tr>
</tbody>
</table>
<p><strong>注意事项</strong>：<br/>
- <code>PretenureSizeThreshold</code> 仅对 Serial 和 ParNew 收集器有效<br/>
- 动态年龄判定会覆盖 <code>MaxTenuringThreshold</code> 设置</p>
<h3 id="_19">垃圾收集器选择</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-XX:+UseSerialGC</code></td>
<td>使用Serial + Serial Old组合（单线程）</td>
</tr>
<tr>
<td><code>-XX:+UseParallelGC</code></td>
<td>使用Parallel Scavenge + Parallel Old组合（多线程，吞吐量优先）</td>
</tr>
<tr>
<td><code>-XX:+UseConcMarkSweepGC</code></td>
<td>使用ParNew + CMS + Serial Old组合（低延迟优先）</td>
</tr>
<tr>
<td><code>-XX:+UseG1GC</code></td>
<td>使用G1收集器（JDK9+默认）</td>
</tr>
<tr>
<td><code>-XX:+UseZGC</code></td>
<td>使用ZGC收集器（JDK11+）</td>
</tr>
<tr>
<td><code>-XX:+UseShenandoahGC</code></td>
<td>使用Shenandoah收集器（JDK12+）</td>
</tr>
</tbody>
</table>
<h3 id="_20">垃圾收集行为调优</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-XX:+DisableExplicitGC</code></td>
<td>禁用System.gc()调用</td>
<td>生产环境推荐开启</td>
</tr>
<tr>
<td><code>-XX:ParallelGCThreads</code></td>
<td>并行GC线程数</td>
<td><code>-XX:ParallelGCThreads=4</code></td>
</tr>
<tr>
<td><code>-XX:ConcGCThreads</code></td>
<td>并发GC线程数（CMS/G1）</td>
<td><code>-XX:ConcGCThreads=2</code></td>
</tr>
<tr>
<td><code>-XX:MaxGCPauseMillis</code></td>
<td>最大GC停顿时间目标</td>
<td><code>-XX:MaxGCPauseMillis=200</code> 目标200ms</td>
</tr>
<tr>
<td><code>-XX:GCTimeRatio</code></td>
<td>GC时间占比</td>
<td><code>-XX:GCTimeRatio=99</code> GC时间不超过1%</td>
</tr>
</tbody>
</table>
<h3 id="cms">CMS 收集器特定参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-XX:CMSInitiatingOccupancyFraction</code></td>
<td>老年代使用率达到多少时触发CMS GC</td>
</tr>
<tr>
<td><code>-XX:+UseCMSCompactAtFullCollection</code></td>
<td>Full GC后进行内存整理</td>
</tr>
<tr>
<td><code>-XX:CMSFullGCsBeforeCompaction</code></td>
<td>多少次Full GC后进行一次碎片整理</td>
</tr>
<tr>
<td><code>-XX:+CMSParallelRemarkEnabled</code></td>
<td>并行标记，降低停顿时间</td>
</tr>
</tbody>
</table>
<h3 id="g1">G1 收集器特定参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-XX:G1HeapRegionSize</code></td>
<td>设置Region大小（1MB-32MB，必须是2的幂）</td>
</tr>
<tr>
<td><code>-XX:G1NewSizePercent</code></td>
<td>新生代最小占比（默认5%）</td>
</tr>
<tr>
<td><code>-XX:G1MaxNewSizePercent</code></td>
<td>新生代最大占比（默认60%）</td>
</tr>
<tr>
<td><code>-XX:InitiatingHeapOccupancyPercent</code></td>
<td>整个堆使用率达到多少时触发并发标记周期（默认45%）</td>
</tr>
</tbody>
</table>
<h3 id="_21">元空间配置</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-XX:MetaspaceSize</code></td>
<td>元空间初始大小</td>
<td><code>-XX:MetaspaceSize=128m</code></td>
</tr>
<tr>
<td><code>-XX:MaxMetaspaceSize</code></td>
<td>元空间最大大小</td>
<td><code>-XX:MaxMetaspaceSize=512m</code></td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>：<br/>
- 不设置 <code>MaxMetaspaceSize</code> 时，元空间只受物理内存限制<br/>
- 动态类加载较多的应用需适当调大</p>
<h3 id="gc_1">GC 日志配置</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-Xlog:gc*</code></td>
<td>JDK9+ GC日志配置</td>
</tr>
<tr>
<td><code>-XX:+PrintGCDetails</code></td>
<td>打印GC详细信息（JDK8）</td>
</tr>
<tr>
<td><code>-XX:+PrintGCDateStamps</code></td>
<td>打印GC时间戳（JDK8）</td>
</tr>
<tr>
<td><code>-Xloggc:gc.log</code></td>
<td>GC日志输出到文件（JDK8）</td>
</tr>
</tbody>
</table>
<h3 id="_22">常用组合配置示例</h3>
<p><strong>高吞吐量场景（批处理任务）</strong>：</p>
<div class="hljs"><pre><span></span><code>java<span class="w"> </span>-Xms4g<span class="w"> </span>-Xmx4g<span class="w"> </span>-Xmn2g<span class="w"> </span>-XX:SurvivorRatio<span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:+UseParallelGC<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:ParallelGCThreads<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:+PrintGCDetails<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-jar<span class="w"> </span>application.jar
</code></pre></div>
<p><strong>低延迟场景（在线服务）</strong>：</p>
<div class="hljs"><pre><span></span><code>java<span class="w"> </span>-Xms4g<span class="w"> </span>-Xmx4g<span class="w"> </span>-XX:+UseG1GC<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:MaxGCPauseMillis<span class="o">=</span><span class="m">200</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:InitiatingHeapOccupancyPercent<span class="o">=</span><span class="m">45</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:+DisableExplicitGC<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-Xlog:gc*:file<span class="o">=</span>gc.log<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-jar<span class="w"> </span>application.jar
</code></pre></div>
<p><strong>超低延迟场景（金融交易系统）</strong>：</p>
<div class="hljs"><pre><span></span><code>java<span class="w"> </span>-Xms16g<span class="w"> </span>-Xmx16g<span class="w"> </span>-XX:+UseZGC<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:ZCollectionInterval<span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-XX:+DisableExplicitGC<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-Xlog:gc*:file<span class="o">=</span>gc.log<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-jar<span class="w"> </span>application.jar
</code></pre></div>
        </div>
    </div>

    <script src="../../../assets/script.js"></script>
    <script>
        // 初始化代码高亮
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        });
    </script>
</body>

</html>